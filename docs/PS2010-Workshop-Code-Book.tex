% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\documentclass[
]{book}
\usepackage{xcolor}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{5}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother
\ifLuaTeX
  \usepackage{luacolor}
  \usepackage[soul]{lua-ul}
\else
  \usepackage{soul}
\fi
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\usepackage[]{natbib}
\bibliographystyle{apalike}
\usepackage{booktabs}  
\usepackage{float}     
\let\cleardoublepage\clearpage  

% Fix table of contents blank pages
\usepackage{etoolbox}
\makeatletter
\patchcmd{\tableofcontents}{\cleardoublepage}{\clearpage}{}{}
\makeatother

% Ensure headings do not appear alone at the bottom of a page
\usepackage{titlesec}
\usepackage{needspace}
\usepackage{lmodern}  

% Keep section headings with at least 5 lines of content
\let\oldsection\section
\renewcommand{\section}{\needspace{5\baselineskip}\oldsection}

\let\oldsubsection\subsection
\renewcommand{\subsection}{\needspace{3\baselineskip}\oldsubsection}  % Move only if less than 3 lines fit

\let\oldsubsubsection\subsubsection
\renewcommand{\subsubsection}{\needspace{2\baselineskip}\oldsubsubsection}  % Smallest headings need 2 lines

% Prevents 'titlesec' errors if the package is missing
\ifdefined\titleformat
  % titlesec is loaded
\else
  \usepackage{titlesec}
\fi

\usepackage{fancyhdr}
\pagestyle{plain}  % Removes headers, keeps page numbers at the bottom
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={PS2010 Workshop Code Book},
  pdfauthor={Luke Kendrick},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{PS2010 Workshop Code Book}
\author{Luke Kendrick}
\date{2026-02-09}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\chapter*{Preface}\label{preface}
\addcontentsline{toc}{chapter}{Preface}

\begin{quote}
This is the PS2010 Psychological Research Methods and Analysis Workshop Codebook.
\end{quote}

\section{About this Code Book}\label{about-this-code-book}

This code book contains information, exercises, and code for the PS2010 workshop sessions.

This is resource is a work in progress, and we're continually updating and improving it.

If you spot an error or something that doesn't look quite right, please get in touch:

\href{mailto:luke.kendrick@rhul.ac.uk}{\nolinkurl{luke.kendrick@rhul.ac.uk}}.

\section{\texorpdfstring{\textbf{License}}{License}}\label{license}

This work is licensed under Creative Commons Attribution-ShareAlike 4.0 International License \href{https://creativecommons.org/licenses/by-sa/4.0/}{(CC-BY-SA 4.0)}. You are free to share and adapt the material for non-commercial purposes, with appropriate credit and under the same license. If you adapt the material, you must distribute your contributions under the same license.

\section{\texorpdfstring{\textbf{Citation}}{Citation}}\label{citation}

Kendrick, L. T. (2025). PS2010 Workshop Code Book (Version 1.0). \url{https://luke-kendrick.github.io/r_codebook}

\chapter{Workshop 1: Data Handling Skills}\label{workshop-1-data-handling-skills}

\textbf{Aims:}

\begin{itemize}
\item
  Practice importing a .csv data file into RStudio using \texttt{read\_csv()}
\item
  Practice inspecting your data in RStudio.
\item
  Use different data wrangling functions to develop your data handling skills.
\item
  Check basic summary statistics.
\end{itemize}

\section{Exercise 1: Import the Data}\label{exercise-1-import-the-data}

\textbf{Import the Data File \texttt{guess\_who.csv}}

Before you begin, you will need the tidyverse package loaded.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{) }\CommentTok{\#install tidyverse if you do not have it.}
\FunctionTok{library}\NormalTok{(tidyverse) }\CommentTok{\#loads tidyverse.}
\end{Highlighting}
\end{Shaded}

Next import the data file and store it as an object called \texttt{dataset}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dataset }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"guess\_who.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

If you see an error saying cannot find function \texttt{read\_csv()} this usually means you have not loaded (or installed) the tidyverse package.

\section{Exercise 2: Inspect and Check Your Data}\label{exercise-2-inspect-and-check-your-data}

\textbf{Take a look at your newly imported data file}

Check the top right panel (the environment) and also use the code below to inspect your data set.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(dataset) }\CommentTok{\# this will open the data in a new tab.}
\FunctionTok{names}\NormalTok{(dataset) }\CommentTok{\# this will show the variable names.}
\end{Highlighting}
\end{Shaded}

It is really important to look at the variable names as you'll be using them in code later on.

Answer Question 2.1 - 2.2 on your worksheet.

\section{Exercise 3: Change a Variable Name}\label{exercise-3-change-a-variable-name}

\textbf{One of the variable names is quite long. This can be annoying if we have to keep typing it out}

Change the variable name \texttt{do\_you\_own\_a\_pet} to \texttt{pet}. The \texttt{rename()} function will let you rename a variable.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dataset }\OtherTok{\textless{}{-}}\NormalTok{ dataset }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{pet =}\NormalTok{ do\_you\_own\_a\_pet)}
\end{Highlighting}
\end{Shaded}

Check it has worked:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(dataset) }\CommentTok{\# ask for the variable names again}
\end{Highlighting}
\end{Shaded}

\section{Exercise 4: Remove a Variable}\label{exercise-4-remove-a-variable}

\textbf{We do not really care about the \texttt{age} variable for the next few exercises.}

Let's remove it.

The code below will create a new object (once we start removing things, it is best to keep the original data file called \texttt{dataset} in the environment)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{\textless{}{-}}\NormalTok{ dataset }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{age)}
\end{Highlighting}
\end{Shaded}

This code will:

\begin{itemize}
\item
  Create a new object called \texttt{mydata}.
\item
  Take our original data called \texttt{dataset}
\item
  ``And then'' \texttt{\%\textgreater{}\%}
\item
  Use the select() function to remove \texttt{age} by placing a minus symbol \texttt{-} in front of it.
\end{itemize}

From now on, we will use the object called \texttt{mydata} and not the original data set.

\section{Exercise 5: Filter Cases}\label{exercise-5-filter-cases}

\textbf{We can select particular cases in our data set}

For example, I could ask: how many people were from the city of Birmingham using the code below:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(city }\SpecialCharTok{==} \StringTok{"birmingham"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{count}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Check the console (bottom left panel) for the answer.

This code will:

\begin{itemize}
\item
  Take \texttt{mydata} and then\ldots{}
\item
  Filter it by the \texttt{city} variable.
\item
  We use a double equals symbol \texttt{==} to specify an exact match.
\item
  I've added ``birmingham'' in speech marks. Note it is lowercase as to match the data set and then\ldots{}
\item
  count() the number of data points.
\end{itemize}

Adapt the code above to answer question 5.1 on the worksheet.

\section{Exercise 6: Guess Who?}\label{exercise-6-guess-who}

\textbf{We can filter based on multiple criteria}.

The code below will show us someone who is from Brighton, has a dog, and does not drink coffee.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(city }\SpecialCharTok{==} \StringTok{"brighton"}\NormalTok{, pet }\SpecialCharTok{==} \StringTok{"dog"}\NormalTok{, coffee }\SpecialCharTok{==} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

We can also use less than/more than symbols to filter data, For example, this will show all people who have a maths enjoyment score of less than 20:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(maths }\SpecialCharTok{\textless{}} \DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Use what you have learned above and adapt your code to play GUESS WHO? and complete questions 6.1-6.2 on the worksheet.

\section{Exercise 7: Create a New Variable}\label{exercise-7-create-a-new-variable}

\textbf{Sometimes we might want to compute new scores or variables}

Add up the three enjoyment scores for \texttt{maths}, \texttt{science}, and \texttt{art} to create an overall score called \texttt{total\_score}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{total\_score =}\NormalTok{ maths }\SpecialCharTok{+}\NormalTok{ science }\SpecialCharTok{+}\NormalTok{ art)}
\end{Highlighting}
\end{Shaded}

This code will:

\begin{itemize}
\item
  Take \texttt{mydata} to overwrite it (ready to add the new variable) and then\ldots{}
\item
  Use the \texttt{mutate()} function to create a new variable named \texttt{total\_score} which should equal \texttt{=} \texttt{maths} \texttt{+} \texttt{science} \texttt{+} \texttt{art}.
\end{itemize}

View the data set and look for the new column to see it has worked.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(mydata)}
\end{Highlighting}
\end{Shaded}

Now, we can look at who had the highest and lowest total enjoyment score.

\texttt{slice\_min} will find the row which has the lowest score:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{slice\_min}\NormalTok{(total\_score)}
\end{Highlighting}
\end{Shaded}

\texttt{slice\_max} will find the row which has the highest score:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{slice\_max}\NormalTok{(total\_score)}
\end{Highlighting}
\end{Shaded}

Answer questions 7.1-7.2 on the worksheet.

\section{Exercise 8: Counting and Removing Missing Data}\label{exercise-8-counting-and-removing-missing-data}

\textbf{Real data sets often are missing data points}

Different people have differing views on how to treat missing data points. For today, we will just identify and remove any. If you view the data, you might notice there are some blanks for \texttt{degree} as not everyone is studying for one.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(mydata}\SpecialCharTok{$}\NormalTok{degree))}
\end{Highlighting}
\end{Shaded}

This code will:

\begin{itemize}
\item
  Calculate the total number using \texttt{sum()} of\ldots{}
\item
  Any missing data points (R calls these \texttt{is.na})
\item
  We can then direct to a particular column using \texttt{mydata\$degree}. This essentially means ``look in \texttt{mydata} and then the column called \texttt{degree}. We use the dollar sign \texttt{\$} to specify the column.
\end{itemize}

If we want to remove them, we can use \texttt{filter()} again!

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(degree))}
\end{Highlighting}
\end{Shaded}

Note: this will overwrite \texttt{mydata} and remove the cases.

Answer question 8.1 on the worksheet.

\section{Exercise 9: Summary Statistics}\label{exercise-9-summary-statistics}

\textbf{We might want to know What was the average enjoyment score?}

We can use this code to look across the data set as a whole:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(mydata)}
\end{Highlighting}
\end{Shaded}

Look through the output in the console (bottom left panel) and answer questions 9.1-9.3 on the worksheet.

\section{Exercise 10: Fixing Luke's Broken Code}\label{exercise-10-fixing-lukes-broken-code}

Help!! My code below is not working. I need your help to fix it\ldots{}

Fix the code below to work out how many coffees were drunk by the person from canterbury and is studying medicine. Try running the code first and then work out why it doesn't work!

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\AttributeTok{city =} \StringTok{"canterburY"}\NormalTok{, degree }\SpecialCharTok{==}\NormalTok{ medicine)}
\end{Highlighting}
\end{Shaded}

Fix the code below to work out the name of the person who is from London, has a hamster, studies psychology, and did not drink coffee. Try running the code first and then work out why it doesn't work!

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{=}
  \FunctionTok{filter}\NormalTok{(city }\SpecialCharTok{==} \StringTok{"London"}\NormalTok{, pet }\SpecialCharTok{==} \StringTok{"hamsta"}\NormalTok{, degree }\SpecialCharTok{==} \StringTok{"psychology"}\NormalTok{, coffee }\SpecialCharTok{\textgreater{}}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Answer questions 10.1-10.2 on the worksheet.

If you get stuck, use the hints below.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for a hint

\begin{itemize}
\item
  Check for spelling errors: there are two of them.
\item
  Make sure to use double equals when specifying a label \texttt{==}.
\item
  Use quote marks when necessary. Some are missing.
\item
  Code is case sensitive. There is a capital letter where there shouldn't be one.
\item
  Use symbols correctly. We want to use the pipe \%\textgreater\% before we filter.
\item
  Use symbols correctly. More than \texttt{\textgreater{}} is not the same as \texttt{\textless{}}.
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Well Done. You have reached the end of the workshop.}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\chapter{Workshop 2: Summarising and Describing Data}\label{workshop-2-summarising-and-describing-data}

\textbf{Aims:}

\begin{itemize}
\item
  Practice importing a .csv data file into RStudio using \texttt{read\_csv()}
\item
  Practice inspecting your data in RStudio.
\item
  Calculate mean and standard deviation using the \texttt{group\_by()} and \texttt{summarise()} functions.
\item
  Visually inspect data using plots and describe data distributions.
\end{itemize}

\section{Exercise 1: Import the Data}\label{exercise-1-import-the-data-1}

\textbf{Import the Data File:} \texttt{stroop.csv}

Before you begin, you will need the tidyverse package loaded.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{) }\CommentTok{\#install tidyverse if you do not have it.}
\FunctionTok{library}\NormalTok{(tidyverse) }\CommentTok{\#loads tidyverse.}
\end{Highlighting}
\end{Shaded}

Next import the data file and store it as an object called \texttt{dataset}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dataset }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"stroop.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

If you see an error saying cannot find function \texttt{read\_csv()} this usually means you have not loaded (or installed) the tidyverse package.

\section{Exercise 2: Inspect and Check Your Data}\label{exercise-2-inspect-and-check-your-data-1}

\textbf{Take a look at your newly imported data file}

Check the top right panel (the environment) and also use the code below to inspect your data set.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(dataset) }\CommentTok{\# this will open the data in a new tab.}
\FunctionTok{names}\NormalTok{(dataset) }\CommentTok{\# this will show the variable names.}
\end{Highlighting}
\end{Shaded}

It is really important to look at the variable names as you'll be using them in code later on.

\section{Exercise 3: Calculate the Stroop Inteference Score}\label{exercise-3-calculate-the-stroop-inteference-score}

\textbf{Sometimes we might want to compute new scores or variables}

Calculate the Stroop interference measure. This should be the difference between the incongruent and congruent conditions. Take the \texttt{incongruent} reaction times and then subtract the \texttt{congruent} reaction times using the code below:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{\textless{}{-}}\NormalTok{ dataset }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{int =}\NormalTok{ incongruent }\SpecialCharTok{{-}}\NormalTok{ congruent)}
\end{Highlighting}
\end{Shaded}

This code will:

\begin{itemize}
\item
  Create an object called \texttt{mydata} before using the original \texttt{dataset} and then\ldots{}
\item
  Use the \texttt{mutate()} function to create a new variable named \texttt{int} which should equal \texttt{=} \texttt{incongruent} \texttt{-} (minus) \texttt{congruent}.
\end{itemize}

View the data set and look for the new column to see it has worked. Note: check the final column to see if \texttt{int} has appeared.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(mydata)}
\end{Highlighting}
\end{Shaded}

What exactly is this Stroop Interference thingy? If you want to learn more, see below.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for more information

The interference measure in milliseconds (msecs) is the amount of extra time it took a participant to answer the incongruent (trickier trials because the colours do not match the word) compared to the congruent trials (easier trial because the colours do match the work).

In a sense, it is how many milliseconds slower you are because you need to focus your attention and engage executive functions to fight the urge to read the word rather than name the colour.

A smaller number is perhaps indicative of having better attention/executive functioning processes!

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Answer questions 3.1-3.2 on the worksheet.

\section{Exercise 4: Calculate Descriptive Statistics}\label{exercise-4-calculate-descriptive-statistics}

Just as shown in the lecture, use the code below to calculate the mean and standard deviation for Stroop interference or \texttt{int}. Remember, we want to use \texttt{int} that was calculated in exercise 3.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{desc }\OtherTok{\textless{}{-}}\NormalTok{  mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(NULL1) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_int =} \FunctionTok{mean}\NormalTok{(NULL2),}
            \AttributeTok{sd\_int =} \FunctionTok{sd}\NormalTok{(NULL2))}
\end{Highlighting}
\end{Shaded}

You will need to change \texttt{NULL} to match your data set. Try and give this a go on your own first, but if you aren't sure look below for help.

Think about:

\begin{itemize}
\item
  For \texttt{NULL1}: What is the name of the variable you will split the data file by (e.g., what is the grouping variable/independent variable called in \texttt{mydata})
\item
  For \texttt{NULL2}: What is the name of the score that you want to find the mean and standard deviation for (e.g., what is the dependent variable called in \texttt{mydata})
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for a hint

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{desc }\OtherTok{\textless{}{-}}\NormalTok{  mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(drink) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_int =} \FunctionTok{mean}\NormalTok{(int),}
            \AttributeTok{sd\_int =} \FunctionTok{sd}\NormalTok{(int))}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

If you look in the environment (top right panel) you will see a new object called \texttt{desc}. This is where your descriptive statistics are stored. I called it \texttt{desc} but you can call it anything you like. It is best to keep object names short and informative. We can now view that object using the \texttt{view()} function.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(desc)}
\end{Highlighting}
\end{Shaded}

Answer questions 4.1-4.2 on the worksheet.

\section{Exercise 5: Explore Data with Plots}\label{exercise-5-explore-data-with-plots}

Generate a box plot:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drink, }\AttributeTok{y =}\NormalTok{ int)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =}\NormalTok{ .}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Generate histograms:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ int, }\AttributeTok{fill =}\NormalTok{ drink)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ drink)}
\end{Highlighting}
\end{Shaded}

Generate density plots:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ int, }\AttributeTok{fill =}\NormalTok{ drink)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ drink)}
\end{Highlighting}
\end{Shaded}

Answer questions 5.1-5.2 in the worksheet.

\section{\texorpdfstring{Exercise 6: What Does \texttt{facet\_wrap()} do?}{Exercise 6: What Does facet\_wrap() do?}}\label{exercise-6-what-does-facet_wrap-do}

Re-run the density plot code, except this time delete the final line. This will show what \texttt{facet\_wrap()} does. What do you notice about the plot now?

Use this code without \texttt{facet\_wrap()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ int, }\AttributeTok{fill =}\NormalTok{ drink)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Answer question 6.1 on the worksheet.

\section{Exercise 7: Save Your Amended Data File}\label{exercise-7-save-your-amended-data-file}

Your current data file has the \texttt{int} column in, calculated in exercise 3. You need to save it so you can use it for next week's workshop. You can overwrite you original .csv file using this code, which will save today's data set.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write.csv}\NormalTok{(mydata, }\StringTok{"stroop.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

This means the \texttt{stroop.csv} file on your computer will be updated and ready to use next week! Make sure you know where it has saved on your computer before you leave. You will need this file next week!

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Well Done. You have reached the end of the workshop.}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\chapter{\texorpdfstring{Workshop 3: \emph{t}-tests}{Workshop 3: t-tests}}\label{workshop-3-t-tests}

\textbf{Aims:}

\begin{itemize}
\item
  Practice running and interpreting a two-sample \emph{t}-test in RStudio.
\item
  Practice running and interpreting a paired \emph{t}-test in RStudio.
\end{itemize}

\textbf{Part One}

Part one of today's workshop will involved running a two-sample t-test, which is appropriate for an independent measures design with \textbf{two} groups.

You should use the same data file from last week, as you will be aiming to investigate whether Stroop interference scores (msecs) significantly differ between the Red Cow group and the control group.

You must have completed the week 2 workshop before starting this one.

\section{Exercise 1: Import the Data}\label{exercise-1-import-the-data-2}

\textbf{Import the Data File:} \texttt{stroop.csv}

Before you begin, you will need the following packages:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{) }\CommentTok{\#install if needed.}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"rstatix"}\NormalTok{)   }\CommentTok{\#install if needed.}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"car"}\NormalTok{)       }\CommentTok{\#install if needed.}
\FunctionTok{library}\NormalTok{(tidyverse)            }\CommentTok{\#load package.}
\FunctionTok{library}\NormalTok{(rstatix)              }\CommentTok{\#load package.}
\FunctionTok{library}\NormalTok{(car)                  }\CommentTok{\#load package.}
\end{Highlighting}
\end{Shaded}

Then import the data file. Make sure it has the \texttt{int} score that you calculated last week. If not, you will need to go back and complete workshop 2.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"stroop.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Exercise 2: Inspect and Check Your Data}\label{exercise-2-inspect-and-check-your-data-2}

\textbf{Take a look at your newly imported data file}

Check the top right panel (the environment) and also use the code below to inspect your data set.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(mydata) }\CommentTok{\# this will open the data in a new tab.}
\FunctionTok{names}\NormalTok{(mydata) }\CommentTok{\# this will show the variable names.}
\end{Highlighting}
\end{Shaded}

It is really important to look at the variable names as you'll be using them in code later on.

\section{Exercise 3: Check Assumptions}\label{exercise-3-check-assumptions}

\subsection{Check Heteroscedasticity with Levene's Test}\label{check-heteroscedasticity-with-levenes-test}

We do not need to do this because we will just use a Welch's \emph{t}-test instead.

If you need to justify this decision (e.g., for a 3rd Year Project), the following papers might help:

\begin{itemize}
\item
  \href{https://rips-irsp.com/articles/10.5334/irsp.82}{Delacre et al.~(2017)}
\item
  \href{https://academic.oup.com/beheco/article/17/4/688/215960}{Ruxton (2006)}
\item
  For a gentler explanation, see also \href{https://daniellakens.blogspot.com/2015/01/always-use-welchs-t-test-instead-of.html}{this blog post} from Daniel Lakens.
\end{itemize}

\subsection{Check Normality with Shapiro-Wilk Test and Histograms}\label{check-normality-with-shapiro-wilk-test-and-histograms}

We need to check normality for both groups separately. We can filter the groups:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#first create a data set that contains the control group only}
\NormalTok{control }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(drink }\SpecialCharTok{==} \StringTok{"control"}\NormalTok{)}
\CommentTok{\#then run the test}
\FunctionTok{shapiro.test}\NormalTok{(control}\SpecialCharTok{$}\NormalTok{int)}

\CommentTok{\#then create a data set that contains Red Cow drinkers only}
\NormalTok{redcow }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(drink }\SpecialCharTok{==} \StringTok{"redcow"}\NormalTok{)}
\CommentTok{\#then run the test}
\FunctionTok{shapiro.test}\NormalTok{(redcow}\SpecialCharTok{$}\NormalTok{int)}
\end{Highlighting}
\end{Shaded}

We use a dollar sign \texttt{\$} to point R to a particular column. For example, when using \texttt{shapiro.test(redcow\$int)} you are saying to run the Shapiro Test on the \texttt{redcow} only data set and the specific column called \texttt{int}

Again, we want the \emph{p}-values to be not significant. A non-significant \emph{p}-value means the data are roughly normally distributed. If the \emph{p}-value is significant, this could be an issue as it indicates the data are not normally distributed.

When reporting the Shapiro-Wilk test, you just need to report the test statistics (\emph{w} = XX) and the \emph{p}-value. Here is an example what it could look like:

\begin{quote}
\emph{W} = 0.98, \emph{p} = .875
\end{quote}

You can also visually check the data with a quick histogram:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{hist}\NormalTok{(control}\SpecialCharTok{$}\NormalTok{int)}
\FunctionTok{hist}\NormalTok{(redcow}\SpecialCharTok{$}\NormalTok{int)}
\end{Highlighting}
\end{Shaded}

Check the plots panel, and use the blue arrow to switch between the two plots.

\section{\texorpdfstring{Exercise 4: Run the Two-Sample \emph{t}-Test and ask for Cohen's d}{Exercise 4: Run the Two-Sample t-Test and ask for Cohen's d}}\label{exercise-4-run-the-two-sample-t-test-and-ask-for-cohens-d}

Run the \emph{t}-test.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(int }\SpecialCharTok{\textasciitilde{}}\NormalTok{ drink, }\AttributeTok{data =}\NormalTok{ mydata, }\AttributeTok{var.equal =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{alternative =} \StringTok{"two.sided"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Ask for Cohen's d:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cohens\_d}\NormalTok{(}\AttributeTok{data =}\NormalTok{ mydata, int }\SpecialCharTok{\textasciitilde{}}\NormalTok{ drink, }\AttributeTok{var.equal =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Interpret your \emph{t}-test.

\begin{itemize}
\item
  Is the test significant?
\item
  What is the effect size?
\item
  If significant, how do the groups differ (e.g., use descriptive statistics to interpret the difference)?
\item
  Hint: re-use the code from last week to find the mean and standard deviation for the two groups.
\end{itemize}

Answer questions 4.1-4.3 on the worksheet.

\section{Part 2 - Exercise 5: Import the Data}\label{part-2---exercise-5-import-the-data}

\textbf{Part Two Study}

Part two of today's workshop will involved running a paired t-test, which is appropriate for a repeated measures design with \textbf{two} conditions.

Let's switch it up a bit and use a different scenario and experiment with a new data set.

Here we will look at how someone's resting heart rate might change as a result of drinking a can of Red Cow.

In this study the resting heart rate in beats per minute (BPM) was measured in a group of participants both \textbf{before} and \textbf{after} consuming a can of Red Cow.

The independent variable is time point: before, after. The dependent variable is BPM.

\textbf{Import the Data}

We will call the object \texttt{dat} (short name for data)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"bpm.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Exercise 6: Inspect and Check Your Data}\label{exercise-6-inspect-and-check-your-data}

\textbf{Take a look at your newly imported data file}

Check the top right panel (the environment) and also use the code below to inspect your data set.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(dat) }\CommentTok{\# this will open the data in a new tab.}
\FunctionTok{names}\NormalTok{(dat) }\CommentTok{\# this will show the variable names.}
\end{Highlighting}
\end{Shaded}

\section{Exercise 7: Check Assumptions}\label{exercise-7-check-assumptions}

We do need to check normality, as heteroscedasiticty does not apply to repeated measures designs. However, we need to ensure the \textbf{difference} score is normally distributed.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diff }\OtherTok{\textless{}{-}}\NormalTok{ dat}\SpecialCharTok{$}\NormalTok{after }\SpecialCharTok{{-}}\NormalTok{ dat}\SpecialCharTok{$}\NormalTok{before  }\CommentTok{\#this will calculate the difference score.}
\FunctionTok{shapiro.test}\NormalTok{(diff)              }\CommentTok{\# run the Shapiro test}
\FunctionTok{hist}\NormalTok{(diff)                      }\CommentTok{\# also visually inspect data}
\end{Highlighting}
\end{Shaded}

You should interpret and report this in the same way as earlier (exercise 3).

Answer questions 7.1-7.2 on the worksheet.

\section{\texorpdfstring{Exercise 8: Run the Paired \emph{t}-Test and ask for Cohen's d}{Exercise 8: Run the Paired t-Test and ask for Cohen's d}}\label{exercise-8-run-the-paired-t-test-and-ask-for-cohens-d}

A paired t-test is a little different compared to the two-sample t-test.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(NULL1, NULL2, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  Change \texttt{NULL1} to the column with the first condition.
\item
  Change \texttt{NULL2} to the column with the second condition.
\end{itemize}

(Hint: you will need to use the dollar sign \texttt{\$} to specify which data set and column, e.g., \texttt{dat\$NULL1} and \texttt{dat\$NULL2}).

Try yourself first, but if you need, check the solution below.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for a hint

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(dat}\SpecialCharTok{$}\NormalTok{before, dat}\SpecialCharTok{$}\NormalTok{after, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Annoyingly, we need to use a different package for Cohen's d for a paired t-test.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"effectsize"}\NormalTok{) }\CommentTok{\#install if needed.}
\FunctionTok{library}\NormalTok{(effectsize)}
\NormalTok{effectsize}\SpecialCharTok{::}\FunctionTok{cohens\_d}\NormalTok{(dat}\SpecialCharTok{$}\NormalTok{before, dat}\SpecialCharTok{$}\NormalTok{after, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Answer questions 8.1-8.2 on the worksheet. Hint: you will also need the descriptive statistics (see exercise 9 below).

\section{Exercise 9: Calculate Descriptive Statistics}\label{exercise-9-calculate-descriptive-statistics}

The final thing to do is to convert the data from wide format to long format. Often with repeated measures when asking for descriptive statistics or plots, we need the data in long format.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{longd }\OtherTok{\textless{}{-}}\NormalTok{ dat }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}
\NormalTok{              before}\SpecialCharTok{:}\NormalTok{after,}
              \AttributeTok{names\_to =} \StringTok{"time"}\NormalTok{,}
              \AttributeTok{values\_to =} \StringTok{"bpm"}
\NormalTok{              )}
\end{Highlighting}
\end{Shaded}

Code explanation:

\begin{itemize}
\item
  Create a new object called \texttt{longd} where we will store the long data.
\item
  Base it on the original data set called \texttt{dat} and then \texttt{\%\textgreater{}\%}
\item
  \texttt{pivot\_longer()}
\item
  The first argument should include the columns which contain your dependent variable. In this case we will use \texttt{before:after}which will then take all and any columns from \texttt{before} through to \texttt{after} (these are the only columns so it will just take the two of them).
\item
  Next we use \texttt{names\_to\ =} to tell R what we want to call our independent variable. I have used ``time'' as it was time point for this study.
\item
  Then we use \texttt{values\_to\ =} to tell R what we want to call our dependent variable. We measure beats per minute, so I have just called this ``bpm''.
\item
  Pay careful attention to the lay out of this code. For example, notice where brackets open and close, and the placement of commas to move on the the next line.
\end{itemize}

Once you have created the new long data set called \texttt{longd} we can use it to calculate descriptive statistics. But first check it to see the difference.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(longd)}
\FunctionTok{names}\NormalTok{(longd)}
\end{Highlighting}
\end{Shaded}

Now adapt the code below to ask for the mean and standard deviation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{desc }\OtherTok{\textless{}{-}}\NormalTok{ longd }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(NULL1) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_bpm =} \FunctionTok{mean}\NormalTok{(NULL2)}
            \AttributeTok{sd\_bpm =} \FunctionTok{sd}\NormalTok{(NULL2))}
\end{Highlighting}
\end{Shaded}

Change \texttt{NULL1} to the name of the independent variable in the \texttt{long} data file, and \texttt{NULL2} to the dependent variable. If this is tricky, use \texttt{names(longd)} if you need a reminder of the variable names and revisit your notes from last week's workshop.

Make note of the mean and standard deviation for the \texttt{before} and \texttt{after} conditions.

Try yourself first, but if you need, check the solution below.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for a hint

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{desc }\OtherTok{\textless{}{-}}\NormalTok{ longd }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_bpm =} \FunctionTok{mean}\NormalTok{(bpm),}
            \AttributeTok{sd\_bpm =} \FunctionTok{sd}\NormalTok{(bpm))}

\FunctionTok{view}\NormalTok{(desc)}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Well Done. You have reached the end of the workshop.}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\chapter{Workshop 4: One-Way ANOVA (Model, Designs, Assumptions)}\label{workshop-4-one-way-anova-model-designs-assumptions}

\textbf{Aims:}

\begin{itemize}
\tightlist
\item
  Practice running one-way ANOVAs for both repeated and independent measures designs.
\item
  Practice checking ANOVA assumptions and interpreting the ANOVA model output.
\end{itemize}

\textbf{Part One}

Part one of today's workshop will involve running a one-way ANOVA for a repeated measures design.

Mild cognitive impairment (MCI) occurs wen someone begins to have difficulty with their memory or other cognitive abilities, however, these are (1) not usually significant enough to interfere with general activities of daily living and (2) do not fully meet the criteria for dementia.

This data set contains data from a new memory assessment used for individuals with MCI across a four year period (each participant was assessed once per year).

Using a one-way ANOVA, can you determine what happens to memory scores over time?

\section{Exercise 1: Import the Data}\label{exercise-1-import-the-data-3}

\textbf{Import the Data File}

Before you begin you will need a few packages loaded.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse) }\CommentTok{\# should already be installed.}

\FunctionTok{install.packages}\NormalTok{(}\StringTok{"afex"}\NormalTok{) }\CommentTok{\# install if needed}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"car"}\NormalTok{) }\CommentTok{\#install if needed}
\FunctionTok{library}\NormalTok{(afex)}
\FunctionTok{library}\NormalTok{(car)}
\end{Highlighting}
\end{Shaded}

Next import the data file and store it as an object called \texttt{dat}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"mci.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Exercise 2: Inspect and Check Your Data}\label{exercise-2-inspect-and-check-your-data-3}

\textbf{Take a look at your newly imported data file}

Check the top right panel (the environment) and also use the code below to inspect your dataset.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(dat) }\CommentTok{\# open data in new tab}
\FunctionTok{names}\NormalTok{(dat) }\CommentTok{\# print variable names to console}
\end{Highlighting}
\end{Shaded}

Is this data in wide format or long format?

If the data is wide, you will need to convert it to long format using the code below.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{\textless{}{-}}\NormalTok{ dat }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =}\NormalTok{ year1}\SpecialCharTok{:}\NormalTok{year4,}
               \AttributeTok{names\_to =} \StringTok{"time"}\NormalTok{,}
               \AttributeTok{values\_to =} \StringTok{"memory"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Here is an explanation of this code line by line. This one is a little tricky.

\begin{itemize}
\item
  First, create a new object called \texttt{mydata} and base it on the existing \texttt{dat} and then\ldots{}
\item
  Pivot the data (from long to wide) by taking all columns starting with \texttt{year1} through to \texttt{year4}. By stating \texttt{year1}:\texttt{year4} you are telling to take all columns from \texttt{year1} through to \texttt{year4}, including anything in between. Essentially you are stating the first and final levels of your independent variable.
\item
  \texttt{names\_to} should include a name you assign to the independent variable. In this study it is time point but we will just use \texttt{time} as it is shorter.
\item
  \texttt{values\_to} should include a name you assign to the dependent variable. In this study it was memory assessment score, but we will just use \texttt{memory}.
\end{itemize}

Run the code and then check \texttt{mydata} to see if it worked.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(mydata)}
\FunctionTok{names}\NormalTok{(mydata)}
\end{Highlighting}
\end{Shaded}

From now on we will only use the \texttt{mydata} object, as it is in long format.

\section{Exercise 3: Check Descriptives}\label{exercise-3-check-descriptives}

Using the code below, generate descriptive statistics to look at the mean memory score across time.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{desc }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(time) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{m\_memory =} \FunctionTok{mean}\NormalTok{(memory),}
            \AttributeTok{sd\_memory =} \FunctionTok{sd}\NormalTok{(memory))}
            
\FunctionTok{view}\NormalTok{(desc) }\CommentTok{\# view the descriptive stats}
\end{Highlighting}
\end{Shaded}

Also, visualise the data using a box plot or density plot.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ time, }\AttributeTok{y =}\NormalTok{ memory)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =}\NormalTok{ .}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
ggplot(mydata, aes(x = memory, fill = time)) +
  geom_density(alpha = .5)
\end{verbatim}

\texttt{facet\_wrap()} is missing from the density plots, however, if you feel it would be beneficial to aid interpretation, you can add it.

\section{Exercise 4: Check Assumptions}\label{exercise-4-check-assumptions}

\textbf{Run the ANOVA model}

Before we start looking at assumptions, we do need to run and store the initial ANOVA model.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod }\OtherTok{\textless{}{-}} \FunctionTok{aov\_ez}\NormalTok{(}\AttributeTok{id =} \StringTok{"id"}\NormalTok{,}
              \AttributeTok{dv =} \StringTok{"memory"}\NormalTok{,}
              \AttributeTok{within =} \StringTok{"time"}\NormalTok{,}
              \AttributeTok{type =} \DecValTok{3}\NormalTok{,}
              \AttributeTok{include\_aov =} \ConstantTok{TRUE}\NormalTok{,}
              \AttributeTok{data =}\NormalTok{ mydata)}
\end{Highlighting}
\end{Shaded}

\textbf{Checking Normality}

First, look to see if the assumption of normality was met. You should look at three things.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  The QQ-Plot
\item
  The histogram
\item
  The Shapiro-Wilk test
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#testing normality, looking at normal distribution of residuals from the model.}
\NormalTok{residuals }\OtherTok{\textless{}{-}} \FunctionTok{residuals}\NormalTok{(mod) }\CommentTok{\#pulls residuals from the model}

\CommentTok{\# produce QQ{-}Plot}
\FunctionTok{qqPlot}\NormalTok{(residuals) }\CommentTok{\#produces a qq{-}plot of residuals}

\CommentTok{\# produce histogram of residuals}
\FunctionTok{hist}\NormalTok{(residuals, }\AttributeTok{breaks =} \DecValTok{20}\NormalTok{, }\AttributeTok{main =} \StringTok{"Histogram of Residuals"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Residuals"}\NormalTok{, }\AttributeTok{col =} \StringTok{"lightblue"}\NormalTok{) }

\CommentTok{\# Shapiro test on residuals}
\FunctionTok{shapiro.test}\NormalTok{(residuals) }\CommentTok{\#Shapiro test for residuals}
\end{Highlighting}
\end{Shaded}

\textbf{Checking Sphericity}

To check sphericity, we need to produce the model output.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(mod) }\CommentTok{\# provides the output of the main ANOVA model with Sphericity output.}
\end{Highlighting}
\end{Shaded}

Look through the output to find: ``Mauchly Tests for Sphericity''.

It will provide a test statistic, reported using \emph{W} = XX.XX

It will provide a \emph{p}-value statistic. For this test, a non-significant \emph{p}-value means the assumption was met. A non-significant \emph{p}-value is one that is a larger value than .05. A significant \emph{p}-value is one smaller than .05.

It looks as though this \emph{p}-value is smaller than .05 and so the assumption is violated. uh-oh!

\section{Exercise 5: Interpret the ANOVA Model}\label{exercise-5-interpret-the-anova-model}

For an easier and more streamlined output to interpret the model, use the code below:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod}\SpecialCharTok{$}\NormalTok{anova\_table}
\end{Highlighting}
\end{Shaded}

You should interpret this the same way as was explained in the lecture. Particularly noting the \emph{F}, degrees of freedom (two values), and \emph{p}-value (noting whether it was significant or not).

This model simply tells us: Should we reject the null hypothesis.

As this is a significant result, \emph{F}(2.15, 105.54) = 127.16, \emph{p}\textless.001, then we can reject our null hypothesis as at least one of the conditions differs. How they differ we do not yet know and you will learn about that next week\ldots{}

\section{Part 2 - Exercise 6: Import the Data}\label{part-2---exercise-6-import-the-data}

\textbf{Part Two}

In this part of the workshop you should conduct a one-way ANOVA for an independent measures design. The general interpretation is the same as above, but as covered in the lecture, the assumptions differ slightly.

In this study, participants were placed into one of three groups based on their circadian chronotype: in other words, are they an early bird (morning person), night owl (evening person), or neither (do not fit into either category). This means we have three independent groups.

You can try this out yourself here: \href{https://qxmd.com/calculate/calculator_829/morningness-eveningness-questionnaire-meq\#}{link}. Probably best to try this after your workshop.

The research question here is a simple one: does the early bird really catch the worm? or more scientifically put\ldots who is more alert when completing an attention task at 9am.

The independent variable is circadian chronotype, 3 levels. The dependent variable is \texttt{score} on an attention task from 0-100 (100 is highly alert/top score).

\textbf{Import the data}

The file is called \texttt{alert.csv}. Import the data file and save it as an object called \texttt{mydata1} (as to not overwrite anything from Part 1 in case you want to look back)

\section{Exercise 7: Check Descriptives}\label{exercise-7-check-descriptives}

Amend the code below to produce descriptive statistics.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(mydata1)  }\CommentTok{\# might be useful to check variable names}
\FunctionTok{view}\NormalTok{(mydata1)   }\CommentTok{\# might be useful to look at the data}

\NormalTok{desc1 }\OtherTok{\textless{}{-}}\NormalTok{ mydata1 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(NULL1) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_score =} \FunctionTok{mean}\NormalTok{(NULL2),}
            \AttributeTok{sd\_score =} \FunctionTok{sd}\NormalTok{(NULL2))}
\end{Highlighting}
\end{Shaded}

Change:

\begin{itemize}
\item
  \texttt{NULL1} to the variable you want to split the data by. This should be the independent variable. This should be the dependent variable as it is names in \texttt{mydata1}.
\item
  \texttt{NULL2} to the variable you want to calculate the mean and sd for. This should be the dependent variable as it is names in \texttt{mydata1}.
\end{itemize}

Also use this code to visualise the data to see what is going on.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata1, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ group, }\AttributeTok{y =}\NormalTok{ score)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =}\NormalTok{ .}\DecValTok{4}\NormalTok{)}
  
\FunctionTok{ggplot}\NormalTok{(mydata1, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ score, }\AttributeTok{fill =}\NormalTok{ group)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =}\NormalTok{ .}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Exercise 8: Check Assumptions}\label{exercise-8-check-assumptions}

Before we start looking at assumptions, we do need to run and store the initial ANOVA model. There are \textbf{four} \texttt{NULL} values you need to change in the code below to match your new data set.

We will save the model as an object called \texttt{mod1}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod1 }\OtherTok{\textless{}{-}} \FunctionTok{aov\_ez}\NormalTok{(}\AttributeTok{id =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{dv =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{between =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{type =} \DecValTok{3}\NormalTok{,}
              \AttributeTok{include\_aov =} \ConstantTok{TRUE}\NormalTok{,}
              \AttributeTok{data =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{Checking Normality}

First, look to see if the assumption of normality was met. You should look at three things.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  The QQ-Plot
\item
  The histogram
\item
  The Shapiro-Wilk test
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#testing normality, looking at normal distribution of residuals from the model.}
\NormalTok{residuals }\OtherTok{\textless{}{-}} \FunctionTok{residuals}\NormalTok{(mod1) }\CommentTok{\#pulls residuals from the model, note name is \textasciigrave{}mod1\textasciigrave{}}

\CommentTok{\# produce QQ{-}Plot}
\FunctionTok{qqPlot}\NormalTok{(residuals) }\CommentTok{\#produces a qq{-}plot of residuals}

\CommentTok{\# produce histogram of residuals}
\FunctionTok{hist}\NormalTok{(residuals, }\AttributeTok{breaks =} \DecValTok{20}\NormalTok{, }\AttributeTok{main =} \StringTok{"Histogram of Residuals"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Residuals"}\NormalTok{, }\AttributeTok{col =} \StringTok{"lightblue"}\NormalTok{) }

\CommentTok{\# Shapiro test on residuals}
\FunctionTok{shapiro.test}\NormalTok{(residuals) }\CommentTok{\#Shapiro test for residuals}
\end{Highlighting}
\end{Shaded}

\textbf{Checking Homogeneity of Variance}

Run and interpret Levene's test using the code below:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{leveneTest}\NormalTok{(score }\SpecialCharTok{\textasciitilde{}}\NormalTok{ group, mydata1)}
\end{Highlighting}
\end{Shaded}

\section{Exercise 9: Interpret the ANOVA Model}\label{exercise-9-interpret-the-anova-model}

Use the code below to interpret the ANOVA model. Decide if the model is significant and whether you can reject the null hypothesis. Also check back at the descriptive statistics to see if you can work out what could be going on.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod1}\SpecialCharTok{$}\NormalTok{anova\_table}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}l@{}}
\toprule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Well Done. You have reached the end of the workshop \\
\end{longtable}

\chapter{Workshop 5: One-Way ANOVA (Post-hocs, Contrasts, Write-up)}\label{workshop-5-one-way-anova-post-hocs-contrasts-write-up}

\textbf{Aims:}

\begin{itemize}
\tightlist
\item
  Practice using a post-hoc test to interpret an ANOVA
\item
  Practice using a planned contrast to interpret an ANOVA result.
\item
  Practice writing-up the results from an ANOVA, using APA style.
\end{itemize}

\textbf{Part One}

\section{Exercise 1: Import Data and Run Model}\label{exercise-1-import-data-and-run-model}

Last week you ran a one-way repeated measures ANOVA looking at memory assessment score over time. This week you will need the same dataset and the code (below) to run the initial model.

Remember - you already checked the assumptions \textbf{and} the ANOVA model was significant, in which case you will now practice using a planned contrast.

To save time, use the code below to load necessary packages, import the data, and run the model. Try running \textbf{ALL} of this code at once to save time (highlight it all and run it). Make sure you working directory is set up correctly first to find the \texttt{mci.csv} file.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"afex"}\NormalTok{) }\CommentTok{\# install if needed}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"car"}\NormalTok{) }\CommentTok{\#install if needed}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(afex)}
\FunctionTok{library}\NormalTok{(car)}

\NormalTok{dat }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"mci.csv"}\NormalTok{)}
\NormalTok{mydata }\OtherTok{\textless{}{-}}\NormalTok{ dat }\SpecialCharTok{\%\textgreater{}\%}

\FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =}\NormalTok{ year1}\SpecialCharTok{:}\NormalTok{year4,}
               \AttributeTok{names\_to =} \StringTok{"time"}\NormalTok{,}
               \AttributeTok{values\_to =} \StringTok{"memory"}\NormalTok{)}
               
\NormalTok{mod }\OtherTok{\textless{}{-}} \FunctionTok{aov\_ez}\NormalTok{(}\AttributeTok{id =} \StringTok{"id"}\NormalTok{,}
              \AttributeTok{dv =} \StringTok{"memory"}\NormalTok{,}
              \AttributeTok{within =} \StringTok{"time"}\NormalTok{,}
              \AttributeTok{type =} \DecValTok{3}\NormalTok{,}
              \AttributeTok{include\_aov =} \ConstantTok{TRUE}\NormalTok{,}
              \AttributeTok{data =}\NormalTok{ mydata)}
              
\NormalTok{mod}\SpecialCharTok{$}\NormalTok{anova\_table}
\end{Highlighting}
\end{Shaded}

\section{Exercise 2: Estimated Marginal Means (EMMs)}\label{exercise-2-estimated-marginal-means-emms}

The code above should import the data, switch it to long format, and run the model.

As the model was significant, we need to pull out the estimated marginal means.

We need a specific package for this:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"emmeans"}\NormalTok{) }\CommentTok{\# install if needed.}
\FunctionTok{library}\NormalTok{(emmeans)}
\end{Highlighting}
\end{Shaded}

Next, pull out the EMMs and save them as an object called \texttt{emms}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{emms }\OtherTok{\textless{}{-}} \FunctionTok{emmeans}\NormalTok{(mod, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ time)}
\end{Highlighting}
\end{Shaded}

Now let's say that the alternate hypothesis for this study was that there would be a linear decline in memory scores over time, we could use a polynomial contrast. This will look for a trend. Polynomial contrasts are only suitable for an independent variable which could be considered ``continuous'' in nature, e.g., time point.

Use the code below to run the contrast.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{poly }\OtherTok{\textless{}{-}} \FunctionTok{contrast}\NormalTok{(emms, }\AttributeTok{method =} \StringTok{"poly"}\NormalTok{)}

\FunctionTok{print}\NormalTok{(poly) }\CommentTok{\# print the results to the console}
\end{Highlighting}
\end{Shaded}

Look through the output. Remember, you should look for \emph{p}-values that are less than .05 (\emph{p} \textless{} .05).

Is there a significant linear, quadratic, or cubic trend?

Additionally, use the code below to visualise this.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#let\textquotesingle{}s visualise the data to help our interpretation}
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ time, }\AttributeTok{y =}\NormalTok{ memory, }\AttributeTok{fill =}\NormalTok{ time)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"line"}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+} 
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot of Memory Score Across Time"}\NormalTok{,  }\CommentTok{\# add a title}
       \AttributeTok{x =} \StringTok{"Time Point"}\NormalTok{,  }\CommentTok{\# X{-}axis label}
       \AttributeTok{y =} \StringTok{"Memory Score"}\NormalTok{)  }\CommentTok{\# Y{-}axis label}
\end{Highlighting}
\end{Shaded}

\section{Part 2 - Exercise 3: Import the Data}\label{part-2---exercise-3-import-the-data}

\textbf{Part Two}

Part two of this workshop will use the same dataset and ANOVA model from part two of workshop 4 (last week).

Ensure you have the correct data file loaded.

The file is called \texttt{alert.csv}. Import the data file and save it as an object called \texttt{mydata1} (as to not overwrite anything from Part 1 in case you want to look back).

\section{Exercise 4: Run the ANOVA Model}\label{exercise-4-run-the-anova-model}

Next, run the ANOVA model again and save it as an object.

We will save the model as an object called \texttt{mod1}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod1 }\OtherTok{\textless{}{-}} \FunctionTok{aov\_ez}\NormalTok{(}\AttributeTok{id =} \StringTok{"id"}\NormalTok{,}
              \AttributeTok{dv =} \StringTok{"score"}\NormalTok{,}
              \AttributeTok{between =} \StringTok{"group"}\NormalTok{,}
              \AttributeTok{type =} \DecValTok{3}\NormalTok{,}
              \AttributeTok{include\_aov =} \ConstantTok{TRUE}\NormalTok{,}
              \AttributeTok{data =}\NormalTok{ mydata1)}
              
\NormalTok{mod1}\SpecialCharTok{$}\NormalTok{anova\_table}
\end{Highlighting}
\end{Shaded}

Last week you would have seen that the model was significant (p-value was less than .05). This means we reject the null hypothesis and at least \textbf{one} of the groups are signficiantly different.

\section{Exercise 5: Post-hoc Pairwise Comparisons}\label{exercise-5-post-hoc-pairwise-comparisons}

To run post-hoc tests, you first need to pull out the estimated marginal means using emmeans() and apply the necessary p-value adjustment.

For this exercise, use the Holm adjustment.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{emmeans}\NormalTok{(mod1,}
\NormalTok{        pairwise }\SpecialCharTok{\textasciitilde{}}\NormalTok{ group,}
        \AttributeTok{adjust =} \StringTok{"holm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Look at the output and interpret it. Which conditions differ from one another? Remember to look for \emph{p}-values that are less than .05.

Also look for effect sizes, so you can report them alongside the rest of your analysis.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(rstatix)}
\FunctionTok{cohens\_d}\NormalTok{(mydata1, score }\SpecialCharTok{\textasciitilde{}}\NormalTok{ group)}
\end{Highlighting}
\end{Shaded}

Use a box plot to also help your interpretation:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#how about a box plot too}

\FunctionTok{ggplot}\NormalTok{(mydata1, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ group, }\AttributeTok{y =}\NormalTok{ score, }\AttributeTok{fill =}\NormalTok{ group)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\section{Exercise 6: Introducting the Violin Plot}\label{exercise-6-introducting-the-violin-plot}

Previously, you have looked at density plots and box plots. Ever wondered if there was a handy way to look at both the distributions and the box plot at the same time? No, probably not. Well I will show you anyway.

Use this code to generate a violin plot:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata1, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ group, }\AttributeTok{y =}\NormalTok{ score, }\AttributeTok{fill =}\NormalTok{ group)) }\SpecialCharTok{+}
  \FunctionTok{geom\_violin}\NormalTok{(}\AttributeTok{trim =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# violin plot without trimming tails}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.1}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# overlay a boxplot for additional summary statistics}
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+}  \CommentTok{\# Classic theme}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Violin Plot of Alertness Score by Group"}\NormalTok{,  }\CommentTok{\# add a title}
       \AttributeTok{x =} \StringTok{"Group"}\NormalTok{,  }\CommentTok{\# x{-}axis label}
       \AttributeTok{y =} \StringTok{"Altertness Score"}\NormalTok{)  }\CommentTok{\# y{-}axis label}
\end{Highlighting}
\end{Shaded}

Mow answer the questions on the Workshop Question Sheet

\begin{longtable}[]{@{}l@{}}
\toprule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Well Done. You have reached the end of the workshop \\
\end{longtable}

\chapter{Workshop 6: Factorial ANOVA: Factorial Designs and an Interactions}\label{workshop-6-factorial-anova-factorial-designs-and-an-interactions}

\textbf{Aims:}

\begin{itemize}
\tightlist
\item
  To practice running and interpreting a factorial ANOVA for an independent measures design.
\item
  To practice plotting an interaction using \texttt{afex\_plot}.
\item
  To practice conducting simple effects analysis to break down and interpret an interaction.
\end{itemize}

\section{Exercise 1: Import Data}\label{exercise-1-import-data}

Before beginning make sure you load the relevant packages.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(afex)}
\end{Highlighting}
\end{Shaded}

The data set this week includes data from a study looking at level of anxiety in young adults who were either rare, regular, or problematic social media users. Participants were then randomly assigned to a notification condition--whether notifications were switched off or turned on.

Import \texttt{socialmedia.csv} and inspect the data set, making note of the variable names.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)}
\FunctionTok{view}\NormalTok{(mydata)}
\FunctionTok{names}\NormalTok{(mydata)}

\CommentTok{\#we also need to ensure any factors are coded as \textasciigrave{}factor\textasciigrave{}}
\NormalTok{mydata}\SpecialCharTok{$}\NormalTok{use }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(mydata}\SpecialCharTok{$}\NormalTok{use)}
\NormalTok{mydata}\SpecialCharTok{$}\NormalTok{notify }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(mydata}\SpecialCharTok{$}\NormalTok{notify)}
\end{Highlighting}
\end{Shaded}

\section{Exercise 2:}\label{exercise-2}

HELP! Before we progress we need to run descriptive statistics. However, the code below is broken and incomplete. Fix the code in order to successfully generate the descriptive stats. There are FOUR issues to resolve.

Try running the code as it is first and check what the error message says.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{desc }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group.by}\NormalTok{(use, notify) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{mean\_anxiety =} \FunctionTok{mean}\NormalTok{(anx),}
    \AttributeTok{sd\_anxiety =} \FunctionTok{sd}\NormalTok{(axn),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{())}
    
\FunctionTok{view}\NormalTok{(des)}
\end{Highlighting}
\end{Shaded}

Box plots are a nice way to visually inspect the data

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ use, }\AttributeTok{y =}\NormalTok{ anx, }\AttributeTok{fill =}\NormalTok{ notify)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Answer question 2.1 on the worksheet.

\section{Exercise 3: Run the ANOVA Model}\label{exercise-3-run-the-anova-model}

Using \texttt{aov\_ez()} run the ANOVA model. You should replace \texttt{NULL} where necessary to match the data set in this workshop.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod }\OtherTok{\textless{}{-}} \FunctionTok{aov\_ez}\NormalTok{(}\AttributeTok{id =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{dv =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{between =} \FunctionTok{c}\NormalTok{(}\StringTok{"NULL"}\NormalTok{, }\StringTok{"NULL"}\NormalTok{),}
              \AttributeTok{type =} \DecValTok{3}\NormalTok{,}
              \AttributeTok{include\_aov =} \ConstantTok{TRUE}\NormalTok{,}
              \AttributeTok{data =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Once you have successfully run the model, an object called \texttt{mod} should now appear in the environment panel. Let's interpret the model

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod}\SpecialCharTok{$}\NormalTok{anova\_table}
\end{Highlighting}
\end{Shaded}

\section{Exercise 4: Plot the Interaction}\label{exercise-4-plot-the-interaction}

It seems as though there is a significant interaction.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{afex\_plot}\NormalTok{(}\AttributeTok{object =}\NormalTok{ mod, }
          \AttributeTok{x =} \StringTok{"use"}\NormalTok{, }
          \AttributeTok{trace =} \StringTok{"notify"}\NormalTok{,}
          \AttributeTok{legend\_title =} \StringTok{"Notification"}\NormalTok{,}
          \AttributeTok{error =} \StringTok{"between"}\NormalTok{,}
          \AttributeTok{factor\_levels =} \FunctionTok{list}\NormalTok{(}\AttributeTok{use =} \FunctionTok{c}\NormalTok{(}\StringTok{"rare"}\NormalTok{, }\StringTok{"regular"}\NormalTok{, }\StringTok{"problematic"}\NormalTok{))) }\SpecialCharTok{+} 
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Inspect the plot and begin to try and interpret what might be driving the significant interaction?

\section{Exercise 5: Simple Effects Analysis (Pairwise)}\label{exercise-5-simple-effects-analysis-pairwise}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(emmeans)}
\NormalTok{emms }\OtherTok{\textless{}{-}} \FunctionTok{emmeans}\NormalTok{(mod, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ use}\SpecialCharTok{*}\NormalTok{notify)}

\NormalTok{contrasts }\OtherTok{\textless{}{-}} \FunctionTok{contrast}\NormalTok{(emms,}
          \AttributeTok{interaction =} \StringTok{"pairwise"}\NormalTok{, }
          \AttributeTok{simple =} \StringTok{"each"}\NormalTok{, }
          \AttributeTok{combine =} \ConstantTok{FALSE}\NormalTok{, }
          \AttributeTok{adjust =} \StringTok{"holm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

The code above with firstly pull out the estimated marginal means (EMMs) before running simple pairwise comparisons with a Holm correction, and saving them as an object called \texttt{contrasts}

Next, print and interpret the contrasts.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(contrasts)}
\end{Highlighting}
\end{Shaded}

\section{Exercise 6: Cohen's d for Simple Effects}\label{exercise-6-cohens-d-for-simple-effects}

We have three pairwise comparisons and so we need three effect sizes.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(effectsize)}

\CommentTok{\# compare notifications for the rare group}
\FunctionTok{cohens\_d}\NormalTok{(anx }\SpecialCharTok{\textasciitilde{}}\NormalTok{ notify, }
         \AttributeTok{data =} \FunctionTok{filter}\NormalTok{(mydata, use }\SpecialCharTok{==} \StringTok{"rare"}\NormalTok{), }
         \AttributeTok{paired =} \ConstantTok{FALSE}\NormalTok{)}
\CommentTok{\# compare notifications for the regular group}
\FunctionTok{cohens\_d}\NormalTok{(anx }\SpecialCharTok{\textasciitilde{}}\NormalTok{ notify, }
         \AttributeTok{data =} \FunctionTok{filter}\NormalTok{(mydata, use }\SpecialCharTok{==} \StringTok{"regular"}\NormalTok{), }
         \AttributeTok{paired =} \ConstantTok{FALSE}\NormalTok{)}
\CommentTok{\# compare notifications for the problematic group}
\CommentTok{\# use the examples above to replace \textasciigrave{}NULL\textasciigrave{}}
\FunctionTok{cohens\_d}\NormalTok{(}\ConstantTok{NULL} \SpecialCharTok{\textasciitilde{}} \ConstantTok{NULL}\NormalTok{, }
         \AttributeTok{data =} \FunctionTok{filter}\NormalTok{(}\ConstantTok{NULL}\NormalTok{, }\ConstantTok{NULL} \SpecialCharTok{==} \StringTok{"NULL"}\NormalTok{), }
         \AttributeTok{paired =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Using the output from exercises 3-6 above, answer questions 3.1-3.5 in the worksheet.

\begin{longtable}[]{@{}l@{}}
\toprule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Well Done. You have reached the end of the workshop \\
\end{longtable}

\chapter{Workshop 7: Factorial ANOVA: Different Designs and Assumptions}\label{workshop-7-factorial-anova-different-designs-and-assumptions}

\textbf{Aims:}

\begin{itemize}
\tightlist
\item
  To practice running and interpreting a factorial ANOVA for a repeated measures design.
\item
  To practice interpreting means for main effects in a 2x2 design.
\item
  To practice evaluating the assumption of normality.
\end{itemize}

\section{Exercise 1: Import Data}\label{exercise-1-import-data-1}

Before beginning make sure you load the relevant packages.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(afex)}
\FunctionTok{library}\NormalTok{(car)}
\end{Highlighting}
\end{Shaded}

The data set this week includes data from a study looking at wellbeing scores after exercise. Participants completing a psychological wellbeing measure before and after two different types of exercise: running and swimming. Participants completed all conditions.

Import \texttt{exercise.csv} and inspect the data set, making note of the variable names.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)}
\FunctionTok{view}\NormalTok{(mydata)}
\FunctionTok{names}\NormalTok{(mydata)}
\end{Highlighting}
\end{Shaded}

Given this is a repeated measures design, you should double check if the data are in long format\ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{longd }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \AttributeTok{cols =} \FunctionTok{starts\_with}\NormalTok{(}\StringTok{"before"}\NormalTok{) }\SpecialCharTok{|} \FunctionTok{starts\_with}\NormalTok{(}\StringTok{"after"}\NormalTok{), }\CommentTok{\# columns to pivot, anything that starts with "before" or "after"}
    \AttributeTok{names\_to =} \FunctionTok{c}\NormalTok{(}\StringTok{"time"}\NormalTok{, }\StringTok{"exercise"}\NormalTok{), }\CommentTok{\# names of new columns}
    \AttributeTok{names\_pattern =} \StringTok{"(before|after)\_(run|swim)"}\NormalTok{, }\CommentTok{\# pattern to separate columns}
    \AttributeTok{values\_to =} \StringTok{"wellbeing"}\NormalTok{) }\CommentTok{\# Name of the value column}
\end{Highlighting}
\end{Shaded}

Once you have run this, \texttt{view()} the data file to see what has changed. You should also check the variable names using \texttt{names()}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(longd)}
\FunctionTok{names}\NormalTok{(longd)}
\end{Highlighting}
\end{Shaded}

You also need to ensure any factors are coded as such\ldots{} As R also puts labels in alphabetical order, it makes sense to place ``before'' ahead of ``after'', so we can use \texttt{levels\ =\ c()} to make that switch.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{longd}\SpecialCharTok{$}\NormalTok{time }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(longd}\SpecialCharTok{$}\NormalTok{time, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"before"}\NormalTok{, }\StringTok{"after"}\NormalTok{))}
\NormalTok{longd}\SpecialCharTok{$}\NormalTok{exercise }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(longd}\SpecialCharTok{$}\NormalTok{exercise)}
\end{Highlighting}
\end{Shaded}

\section{Exercise 2: Descriptives}\label{exercise-2-descriptives}

Use the code below to generate descriptive statistics.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{desc }\OtherTok{\textless{}{-}}\NormalTok{ longd }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(time, exercise) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{m =} \FunctionTok{mean}\NormalTok{(wellbeing), }
            \AttributeTok{sd =} \FunctionTok{sd}\NormalTok{(wellbeing), }
            \AttributeTok{n =} \FunctionTok{n}\NormalTok{())}

\FunctionTok{view}\NormalTok{(desc)}
\end{Highlighting}
\end{Shaded}

How about a boxplot too? However, you will need to decide what to place on the x and y axis, and which variable should have a colour fill by replacing \texttt{NULL} below.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(longd, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NULL}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Answer question 2.1 on the worksheet.

\section{Exercise 3: Run the ANOVA Model}\label{exercise-3-run-the-anova-model-1}

Using \texttt{aov\_ez()} run the ANOVA model. You should replace \texttt{NULL} where necessary to match the data set in this workshop.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod }\OtherTok{\textless{}{-}} \FunctionTok{aov\_ez}\NormalTok{(}\AttributeTok{id =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{dv =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{within =} \FunctionTok{c}\NormalTok{(}\StringTok{"NULL"}\NormalTok{, }\StringTok{"NULL"}\NormalTok{),}
              \AttributeTok{type =} \DecValTok{3}\NormalTok{,}
              \AttributeTok{include\_aov =} \ConstantTok{TRUE}\NormalTok{,}
              \AttributeTok{data =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Once you have successfully run the model, an object called \texttt{mod} should now appear in the environment panel. Let's interpret the model

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod}\SpecialCharTok{$}\NormalTok{anova\_table}
\end{Highlighting}
\end{Shaded}

Is the interaction significant? Decide for yourself. If it is, you should use the code from exercises 4-6 from last week's workshop (workshop 6).

If not, as the two independent variables each only have two levels, you can interpret any main effects by looking at the descriptive statistics and/or plots.

Remember to amend the group\_by() line of code in the descriptives to work out the statistics for each independent variable separately (as shown in the lecture).

Use the hint below if needed.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for a hint

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{exercise }\OtherTok{\textless{}{-}}\NormalTok{ longd }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(exercise) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{m =} \FunctionTok{mean}\NormalTok{(wellbeing), }
            \AttributeTok{sd =} \FunctionTok{sd}\NormalTok{(wellbeing), }
            \AttributeTok{n =} \FunctionTok{n}\NormalTok{())}
\FunctionTok{view}\NormalTok{(exercise)}
\end{Highlighting}
\end{Shaded}

Now try to amend the code to find the descriptives for the main effect of \texttt{time}.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Answer questions 3.1-3.5 on the worksheet.

\section{Exercise 4: Check Model Assumptions}\label{exercise-4-check-model-assumptions}

The assumption of Sphericity is automatically checked and corrected for (if necessary). However, for a repeated measures design with only two-levels for each independent variable, Sphericity does not apply.

This means for a 2x2 repeated measures design, we will only check normality of residuals.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# testing normality, looking at normal distribution of residuals from the model.}
\NormalTok{residuals }\OtherTok{\textless{}{-}} \FunctionTok{residuals}\NormalTok{(mod) }\CommentTok{\#pulls residuals from the model}
\FunctionTok{qqPlot}\NormalTok{(residuals) }\CommentTok{\#produces a qq{-}plot of residuals}
\FunctionTok{hist}\NormalTok{(residuals, }\AttributeTok{breaks =} \DecValTok{20}\NormalTok{, }\AttributeTok{main =} \StringTok{"Histogram of Residuals"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Residuals"}\NormalTok{, }\AttributeTok{col =} \StringTok{"lightblue"}\NormalTok{) }\CommentTok{\#histogram of residuals}
\FunctionTok{shapiro.test}\NormalTok{(residuals) }\CommentTok{\#Shapiro test for residuals}
\end{Highlighting}
\end{Shaded}

Next week you'll also check assumptions for a mixed-design, including checking homogeneity of variance.

\textbf{The next exercises are important to help you continue to develop your understanding of code, research methods, and statistics}

\section{Exercise 5: Data Visualisation}\label{exercise-5-data-visualisation}

You might notice that many of the plots initially generated by R are not ``publication'' ready.

The code below is quite long, but have a go at running it and look at the graph it produces.

Keep in mind you will look at data visualisation in a little more detail in a few weeks\ldots{}

Consider whether a figure like this might be useful for your upcoming lab report.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(longd, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ time, }\AttributeTok{y =}\NormalTok{ wellbeing, }\AttributeTok{fill =}\NormalTok{ exercise)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun.data =}\NormalTok{ mean\_sdl, }\AttributeTok{geom =} \StringTok{"errorbar"}\NormalTok{, }
               \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{), }\AttributeTok{width =} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,   }\CommentTok{\# leave this as NULL because APA figures do not use titles.}
    \AttributeTok{x =} \StringTok{"Time Point"}\NormalTok{,  }
    \AttributeTok{y =} \StringTok{"Mean Wellbeing Score"}\NormalTok{,}
    \AttributeTok{fill =} \StringTok{"Exercise"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"run"} \OtherTok{=} \StringTok{"slategray4"}\NormalTok{, }\StringTok{"swim"} \OtherTok{=} \StringTok{"slategray2"}\NormalTok{), }
                    \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Run"}\NormalTok{, }\StringTok{"Swim"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"before"} \OtherTok{=} \StringTok{"Before"}\NormalTok{, }\StringTok{"after"} \OtherTok{=} \StringTok{"After"}\NormalTok{)) }\SpecialCharTok{+}
  \CommentTok{\# layer 6: add the theme to tidy up}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{14}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\section{Exercise 6: Understanding Designs}\label{exercise-6-understanding-designs}

In the following exercises, the drop down will turn \textbf{green if correct} and \textbf{red if incorrect}.

\subsection{Look at the code below and answer the questions:}\label{look-at-the-code-below-and-answer-the-questions}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod }\OtherTok{\textless{}{-}} \FunctionTok{aov\_ez}\NormalTok{(}\AttributeTok{id =} \StringTok{"id"}\NormalTok{,}
              \AttributeTok{between =} \FunctionTok{c}\NormalTok{(}\StringTok{"group"}\NormalTok{, }\StringTok{"handedness"}\NormalTok{), }
              \AttributeTok{dv =} \StringTok{"reaction\_time"}\NormalTok{, }
              \AttributeTok{type =} \DecValTok{3}\NormalTok{,}
              \AttributeTok{data =}\NormalTok{ df)}
\end{Highlighting}
\end{Shaded}

\begin{quote}
\textbf{Question 1: Based on the code above, what was the design of this study?}

-- choose an answer -- A. Repeated Measures B. Independent Measures C. Mixed Design
\end{quote}

\begin{quote}
\textbf{Question 2: Based on the code above, what object name was the data set saved as?}

-- choose an answer -- A. id B. df C. mod
\end{quote}

\subsection{Look at the code below and answer the questions.}\label{look-at-the-code-below-and-answer-the-questions.}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod }\OtherTok{\textless{}{-}} \FunctionTok{aov\_ez}\NormalTok{(}\AttributeTok{id =} \StringTok{"id"}\NormalTok{,}
              \AttributeTok{between =} \StringTok{"group"}\NormalTok{,}
              \AttributeTok{within =} \StringTok{"time\_point"}\NormalTok{,}
              \AttributeTok{dv =} \StringTok{"anxiety"}\NormalTok{, }
              \AttributeTok{type =} \DecValTok{3}\NormalTok{,}
              \AttributeTok{data =}\NormalTok{ mydata)}
\end{Highlighting}
\end{Shaded}

\begin{quote}
\textbf{Question 3: Based on the code above, what was the design of this study?}

-- choose an answer -- A. Repeated Measures B. Independent Measures C. Mixed Design
\end{quote}

\begin{quote}
\textbf{Question 4: Based on the code above, what object name was the repeated condition called?}

-- choose an answer -- A. group B. anxiety C. time\_point
\end{quote}

\section{Exercise 7: ``Significant or Non-Significant, That is the question''}\label{exercise-7-significant-or-non-significant-that-is-the-question}

\begin{quote}
\textbf{Question 5: You see a \emph{p}-value reported as \emph{p} \textless{} .001.}

Significant or non-significant? -- choose an answer -- Significant Non-Significant
\end{quote}

\begin{quote}
\textbf{Question 6: You see a \emph{p}-value in RStudio as 4.237e-14}

Significant or non-significant? -- choose an answer -- Significant Non-Significant
\end{quote}

\begin{quote}
\textbf{Question 7: You see a \emph{p}-value in RStudio as 0.5364}

Significant or non-significant? -- choose an answer -- Significant Non-Significant
\end{quote}

\begin{quote}
\textbf{Question 8: You see a \emph{p}-value in RStudio as 0.0593}

Significant or non-significant? -- choose an answer -- Significant Non-Significant
\end{quote}

\section{Exercise 8: HELP! My Code Won't Work}\label{exercise-8-help-my-code-wont-work}

A friend is trying to run some code. They want to run a factorial ANOVA and then pull out the estimated marginal means, but it is not working!

Use your expert code skills to identify where the issue is by looking through the code below.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod }\OtherTok{\textless{}{-}} \FunctionTok{aov\_ez}\NormalTok{(}\AttributeTok{id =} \StringTok{"id"}\NormalTok{,}
              \AttributeTok{dv =} \StringTok{"score"}\NormalTok{,}
              \AttributeTok{between =} \StringTok{"treatment"}\NormalTok{,}
              \AttributeTok{within =} \StringTok{"time"}\NormalTok{,}
              \AttributeTok{type =} \DecValTok{3}\NormalTok{,}
              \AttributeTok{include\_aov =} \ConstantTok{TRUE}\NormalTok{,}
              \AttributeTok{data =}\NormalTok{ mydata)}
\NormalTok{mod}\SpecialCharTok{$}\NormalTok{anova\_table}

\FunctionTok{library}\NormalTok{(emmeans)}
\NormalTok{emms }\OtherTok{\textless{}{-}} \FunctionTok{emmeans}\NormalTok{(mid, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ treatment}\SpecialCharTok{*}\NormalTok{time)}

\NormalTok{contrasts }\OtherTok{\textless{}{-}} \FunctionTok{contrast}\NormalTok{(eemms,}
          \AttributeTok{interaction =} \StringTok{"pairwise"}\NormalTok{, }
          \AttributeTok{simple =} \StringTok{"each"}\NormalTok{, }
          \AttributeTok{combine =} \ConstantTok{FALSE}\NormalTok{, }
          \AttributeTok{adjust =} \StringTok{"holm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Take your time to look through the code and spot \textbf{two} issues and then answer the questions below.

\begin{quote}
\textbf{Question 9: Based on the code above, what was the first issue?} -- choose an answer -- A. ``treatment'' is misspelled B. include\_aov should = FALSE C. mod was spelled as ``mid''
\end{quote}

\begin{quote}
\textbf{Question 10: Based on the code above, what was the second issue?} -- choose an answer -- A. eems should be emms B. adjust = ``holm'' is incorrect C. contrast is misspelled
\end{quote}

\begin{longtable}[]{@{}l@{}}
\toprule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Well Done. You have reached the end of the workshop \\
\end{longtable}

\chapter{Workshop 8: Factorial ANOVA: Mixed Design Factorial ANOVA}\label{workshop-8-factorial-anova-mixed-design-factorial-anova}

\textbf{Aims:}

\begin{itemize}
\tightlist
\item
  Practice importing and wrangling data ready for analysis.
\item
  Practice running a mixed design factorial ANOVA, including interpreting the model and running any follow-up analyses.
\item
  Practice evaluating model assumptions.
\item
  Practice generating plots and writing-up the analysis.
\end{itemize}

\textbf{Introduction}

This week's workshop is going to bring together several things you have covered so far during PS2010, including right back to the week one workshop. Today you are going to analyse a data set starting from a ``messy'' data set right the way through to producing some fancy data visualisations to show off your findings.

All of the steps covered in today's workshop could be helpful for your lab report analysis and write-up.

There are quite a few steps today and so don't worry if you cannot complete them all in the allotted time, but instead save your script and use your independent study time to complete it.

\textbf{Today's Research Scenario}

There are lots of tasks where our performance can be negatively impacted by distractions. There are some tasks whereby we should solely focus on what we are doing, for example, when completing this workshop or driving a car.

If you are distracted completing this workshop, the worst that could happen is that you make a mistake with your code. Distractions when driving can have much more serious consequences. Today's research question is: How do distractions impact our ability to detect different types of hazards when driving.

Sixty experienced drivers (minimum 1 year driving experience) were recruited to take part in a driving simulation task, whereby they had to identify different hazards. Participants were first randomly allocated to one of two conditions.

\begin{itemize}
\item
  Independent variable 1 (distraction yes/no):

  \begin{itemize}
  \item
    Yes: participants were required to answer questions by the researcher via a hands free headset whilst in the simulator.
  \item
    No: participants were left to drive uninterrupted in the simulator.
  \end{itemize}
\end{itemize}

\begin{quote}
\textbf{Question 1: Was this variable independent or repeated measures?} -- choose an answer -- A. Independent Measures B. Repeated Measures
\end{quote}

During the driving simulation task, participants had to identify hazards (e.g., a car pulling out in front, or a pedestrian stepping out) by pressing a button. There were three different types of hazard that participants saw.

\begin{itemize}
\item
  Independent variable 2 (hazard type: car, bike, pedestrian)

  \begin{itemize}
  \item
    Car: a car was the cause of the hazard.
  \item
    Bike: a bicycle was the cause of the hazard
  \item
    Pedestrian: a pedestrian was the cause of the hazard.
  \end{itemize}
\end{itemize}

\begin{quote}
\textbf{Question 2: Was this variable independent or repeated measures?} -- choose an answer -- A. Independent Measures B. Repeated Measures
\end{quote}

The dependent variable in this study was the number of hazards correctly identified. The driving task was split into \textbf{two} blocks, and there were a maximum of 10 hazards for each hazard type in each block (total 30 hazards per block).

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Workshop Outline}

The workshop is split into different parts:

\textbf{Exercises 1-2}: Import and Prepare Data for Analysis This will involve setting up RStudio, importing the data, and any data wrangling tasks to ensure the data is in the correct format prior to analysis.

\textbf{Exercise 3}: Calculate Statistics This will involve running initial descriptive statistics and the initial ANOVA model.

\textbf{Exercises 4-6} Carrying out any additional analyses (e.g., examine the interaction or interpret main effects) depending on the outcome of the initial ANOVA model.

\textbf{Exercise 7} Evaluate the model. This will be checking any necessary assumptions.

\textbf{Exercise 8} Generate publication worthy figures and write-up the results.

Let's begin\ldots{}

\section{Exercise 1: Prepare RStudio and Import the Data}\label{exercise-1-prepare-rstudio-and-import-the-data}

You'll need these packages:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(afex)}
\FunctionTok{library}\NormalTok{(car)}
\FunctionTok{library}\NormalTok{(emmeans)}
\FunctionTok{library}\NormalTok{(effectsize)}
\end{Highlighting}
\end{Shaded}

Import the data set from the csv file called \texttt{hazard.csv}.

View the data to familiarise yourself with it:

\begin{itemize}
\item
  \texttt{id}: the identifier.
\item
  \texttt{age}: participant age in years.
\item
  \texttt{exp\_code}: was a code used to log in to the simulator experiment system for that participant.
\item
  \texttt{years\_driving}: how many years they have been driving.
\item
  \texttt{distraction}: which distraction condition they were randomly assigned to.
\item
  \texttt{block1\_car} and \texttt{block2\_car}: the number of car hazards identified in blocks 1 and 2 respectively.
\item
  \texttt{block1\_bike} and \texttt{block2\_bike}: the number of bike hazards identified in blocks 1 and 2 respectively.
\item
  \texttt{block1\_pedestrian} and \texttt{block2\_pedestrian}: the number of pedestrian hazards identified in blocks 1 and 2 respectively.
\end{itemize}

\section{Exercise 2: Data Wrangling}\label{exercise-2-data-wrangling}

The data set is a bit busier than what you have seen before, and requires some work before it is ready to analyse. This is a normal part of data analysis.

\begin{itemize}
\tightlist
\item
  You need to calculate the total number of hazards correctly identified, because these are split over two blocks at the moment.
\end{itemize}

\begin{quote}
\textbf{Question 3: Which R function could help with this?} -- choose an answer -- A. filter() B. select() C. mutate()
\end{quote}

\begin{itemize}
\tightlist
\item
  There are a few variables in the data set we don't really need, you could get rid of them to clean up the data set if you want.
\end{itemize}

\begin{quote}
\textbf{Question 4: Which R function could help with this?} -- choose an answer -- A. filter() B. select() C. mutate()
\end{quote}

\begin{itemize}
\tightlist
\item
  The data has a repeated measures variable and this is in wide format currently. You will need long format data.
\end{itemize}

\begin{quote}
\textbf{Question 5: Which R function could help with this?} -- choose an answer -- A. pivot\_longer() B. filter() C. group\_by()
\end{quote}

\textbf{Calculate the Total Scores}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{car =}\NormalTok{ block1\_car }\SpecialCharTok{+}\NormalTok{ block2\_car,}
         \AttributeTok{bike =}\NormalTok{ block1\_bike }\SpecialCharTok{+}\NormalTok{ block2\_bike,}
         \AttributeTok{pedestrian =}\NormalTok{ block1\_pedestrian }\SpecialCharTok{+}\NormalTok{ block2\_pedestrian)}
\end{Highlighting}
\end{Shaded}

This code will create three new variables: \texttt{car}, \texttt{bike}, and \texttt{pedestrian} to contain the sum of the two blocks. You used the \texttt{mutate()} function in week 1's workshop.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(mydata)}
\end{Highlighting}
\end{Shaded}

Can you spot the new variables that you created?

\textbf{Select Relevant Variables}

Use \texttt{names(mydata)} for a list of the variables in the data set. Use the code below to select the variables you will need for your ANOVA analysis. You do not need everything in the original \texttt{mydata} data set.

For example, we really don't need the original \texttt{block1\_} or \texttt{block2\_} scores now we have the totals from above, and similarly, the \texttt{exp\_code} is not needed for our analysis.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata\_clean }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\ConstantTok{NULL}\NormalTok{, }\ConstantTok{NULL}\NormalTok{, }\ConstantTok{NULL}\NormalTok{, }\ConstantTok{NULL}\NormalTok{) }\CommentTok{\# add as many as necessary}
\end{Highlighting}
\end{Shaded}

Change each \texttt{NULL} to a variable you want to keep (each separated by a comma). You used the \texttt{select()} function in week 1's workshop. Note: this code creates a new object called \texttt{mydata\_clean} so that we don't overwrite the original \texttt{mydata} object.

Use the hint below if needed.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for a hint

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata\_clean }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(id, age, years\_driving, distraction, car, bike, pedestrian)}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(mydata\_clean)}
\end{Highlighting}
\end{Shaded}

Do you notice that there are fewer variables in this data set? That looks a bit tidier!

\textbf{Convert from Wide to Long format}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{longd }\OtherTok{\textless{}{-}}\NormalTok{ mydata\_clean }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \AttributeTok{cols =}\NormalTok{ car}\SpecialCharTok{:}\NormalTok{pedestrian,}
    \AttributeTok{names\_to =} \StringTok{"hazard"}\NormalTok{,}
    \AttributeTok{values\_to =} \StringTok{"acc"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

This will create two new labels: \texttt{hazard} for type of hazard, and \texttt{acc} for number of hazards correctly identified (accuracy). From now on you should use the \texttt{longd} object.

\textbf{Re-code Any Factors}

Last bit of wrangling. Make sure you have any factors coded as a Factor and not a character.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{longd}\SpecialCharTok{$}\NormalTok{distraction }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(longd}\SpecialCharTok{$}\NormalTok{distraction)}
\NormalTok{longd}\SpecialCharTok{$}\NormalTok{hazard }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(longd}\SpecialCharTok{$}\NormalTok{hazard)}
\end{Highlighting}
\end{Shaded}

Now you are ready for the real analysis.

\section{Exercise 3: Descriptive Stats and the Model}\label{exercise-3-descriptive-stats-and-the-model}

Calculate descriptive statistics just like you have done in previous weeks.

Use \texttt{names(longd)} if you need a reminder of the variable names.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{desc }\OtherTok{\textless{}{-}}\NormalTok{ longd }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(}\ConstantTok{NULL}\NormalTok{, }\ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_acc =} \FunctionTok{mean}\NormalTok{(}\ConstantTok{NULL}\NormalTok{),}
              \AttributeTok{sd\_acc =} \FunctionTok{sd}\NormalTok{(}\ConstantTok{NULL}\NormalTok{))}
\FunctionTok{view}\NormalTok{(desc)}
\end{Highlighting}
\end{Shaded}

You could also generate a box plot if you like (use code from previous weeks) but we will generate some visualisations later on.

Now to run the initial ANOVA model\ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mod }\OtherTok{\textless{}{-}} \FunctionTok{aov\_ez}\NormalTok{(}\AttributeTok{id =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{dv =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{within =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{between =} \StringTok{"NULL"}\NormalTok{,}
              \AttributeTok{type =} \DecValTok{3}\NormalTok{,}
              \AttributeTok{include\_aov =} \ConstantTok{TRUE}\NormalTok{,}
              \AttributeTok{data =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Take extra care to ensure you enter the correct variable for the \texttt{within} and \texttt{between} lines of code. Look back over the study scenario section at the start of the workshop if you need.

\textbf{Sphericity Check}

As one of the independent variables is repeated measures we need to run an extra check here.

aov\_ez() will automatically check Sphericity for you when you have a repeated measures variable with three or more levels, and it will essentially produce two ANOVA models: a corrected model and an uncorrected model. You need to decide which one to use.

If the assumption of Sphericity is violated, you should use the corrected model.
If the assumption of Sphericity is met, you can use the uncorrected model.

To check, produce the model output but this time using \texttt{summary(mod)} as this gives us some extra information.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(mod)}
\end{Highlighting}
\end{Shaded}

Check the output and look for Mauchly Tests for Sphericity:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Mauchly Tests }\ControlFlowTok{for}\NormalTok{ Sphericity}

\NormalTok{                   Test statistic p}\SpecialCharTok{{-}}\NormalTok{value}
\NormalTok{hazard                    }\FloatTok{0.96285} \FloatTok{0.33993}
\NormalTok{distraction}\SpecialCharTok{:}\NormalTok{hazard        }\FloatTok{0.96285} \FloatTok{0.33993}
\end{Highlighting}
\end{Shaded}

To report the assumption based on the output above, i'd write something like:
\textgreater{} Mauchly's test indicated that the assumption of sphericity was not violated for the main effect of hazard, \emph{w} = .96, \emph{p} = .340 or the distraction Ã— hazard interaction, \emph{W} = .96 , \emph{p} = .340.

As these p-values were not-significant this means that Sphericity was NOT violated and the assumption was met. This now means we can report the ANOVA model without any correction.

If the assumption is violated (either \emph{p}-value is less than 0.05 and therefore significant) then you should use and report the corrected model. To find this just use:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{nice}\NormalTok{(mod)}
\end{Highlighting}
\end{Shaded}

If you run this now to compare, you'll notice that the degrees of freedon are slightly adjusted (they're not whole numbers) and some other values, such as \emph{p}-values, might have changed slightly. If you see \texttt{Sphericity\ correction\ method:\ GG} this meand a Greenhouse-Geisser correction has been applied and you should include that information in your write-up.

As for today's scenario the assumption was met, continue wit the uncorrected model.

Interpret the ANOVA model and decide what should happen next\ldots{}

\begin{quote}
\textbf{The first main effect (distraction) is} -- choose an answer -- Not significant Significant
\end{quote}

\begin{quote}
\textbf{The second main effect (hazard type) is} -- choose an answer -- Not significant Significant
\end{quote}

\begin{quote}
\textbf{The distraction by hazard type interaction is} -- choose an answer -- Not significant Significant
\end{quote}

\section{Exercise 4: Interpreting the Main effect of Distraction}\label{exercise-4-interpreting-the-main-effect-of-distraction}

As there are only two levels, you can just use the mean values to interpret the direction. You can also use a box plot too.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m\_distract }\OtherTok{\textless{}{-}}\NormalTok{ longd }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(}\ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_acc =} \FunctionTok{mean}\NormalTok{(}\ConstantTok{NULL}\NormalTok{),}
              \AttributeTok{sd\_acc =} \FunctionTok{sd}\NormalTok{(}\ConstantTok{NULL}\NormalTok{))}
\FunctionTok{view}\NormalTok{(m\_distract)}

\FunctionTok{ggplot}\NormalTok{(longd, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ distraction, }\AttributeTok{y =}\NormalTok{ acc)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{quote}
\textbf{Question 9: Which statement is the correct interpretation of this main effect?} -- choose an answer -- A. Hazard perception was higher in the ``distraction = Yes'' condition B. Hazard perception was higher in the ``distraction = No'' condition
\end{quote}

\section{Exercise 5: Interpreting the Main Effect of Hazard Type}\label{exercise-5-interpreting-the-main-effect-of-hazard-type}

As there are more than two levels for this main effect, we cannot simply look at the means just yet, as it won't be clear which conditions are \textbf{significantly} different. All the main tell us is that \textbf{at least one} of them are significantly different, but which one?

Here you will need to follow the same steps as a one-way ANOVA (see Workshops 4 \& 5 for a refresher). As the main effect was significant, in this scenario you will run post-hoc multiple comparisons to see how they differ. Work through the code below to figure out how to best interpret this main effect using:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  pairwise comparisons
\item
  box plot for visualising data
\item
  means and standard deviation descriptive statistics
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{emmeans}\NormalTok{(mod,}
\NormalTok{        pairwise }\SpecialCharTok{\textasciitilde{}}\NormalTok{ hazard,}
        \AttributeTok{adjust =} \StringTok{"holm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(longd, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ hazard, }\AttributeTok{y =}\NormalTok{ acc)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m\_hazard }\OtherTok{\textless{}{-}}\NormalTok{ longd }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(hazard) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{mean\_acc =} \FunctionTok{mean}\NormalTok{(acc),}
            \AttributeTok{sd\_acc =} \FunctionTok{sd}\NormalTok{(acc))}
\FunctionTok{view}\NormalTok{(m\_hazard)}
\end{Highlighting}
\end{Shaded}

You have used the emmeans() function before in week 5's workshop. Interpret the output.

\begin{quote}
\textbf{Question 10: Which was the only pairwise comparison that was NOT significant?} -- choose an answer -- A. bike vs.~car B. car vs.~pedestrian C. bike vs.~pedestrian
\end{quote}

\begin{quote}
\textbf{Question 11: Using all available information, which statement is NOT a correct interpretation of this main effect?} -- choose an answer -- A. Cars were easier to spot than bikes B. Bikes were easier to spot than pedestrians C. Cars were easier to spot than pedestrians
\end{quote}

\begin{quote}
\textbf{Question 12: Using all available information, which statement is the correct interpretation of this main effect?} -- choose an answer -- A. Pedestrians were significantly easier to spot than bikes B. Bikes and pedestrians were spotted equally as often C. Bikes were significantly easier to spot than pedestrians
\end{quote}

\section{Exercise 6: Effect Sizes}\label{exercise-6-effect-sizes}

So far you have the initial ANOVA model which gave you:

\begin{itemize}
\tightlist
\item
  \emph{F}, df, and \emph{p} for each main effect and the interaction.
\end{itemize}

Descriptive statistics for main effect of distraction which gave you:

\begin{itemize}
\tightlist
\item
  Mean and standard deviation of identified hazard for the two groups (yes, no for presence of distraction)
\end{itemize}

Descriptive statistics and pairwise comparisons for main effect of hazard type which gave you:

\begin{itemize}
\tightlist
\item
  Mean and standard deviation of identified hazards for the three conditions (car, bike, pedestrian for hazard type) and \emph{t}, df, and \emph{p} from pairwise comparisons between the three.
\end{itemize}

But what about effect sizes?

For the ANOVA model, you should look at partial eta squared (\(Î·_P^2\)). This is super quick and easy to check from the ANOVA model \texttt{mod} using this code:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{eta\_squared}\NormalTok{(mod)}
\end{Highlighting}
\end{Shaded}

You can report the full \emph{F}-statement in APA format like this:

\emph{F}(\ul{df1}, \ul{df2}) = \ul{value}, \emph{p} = \ul{value}, \(Î·_P^2\) = \ul{value}

Anything underlined needs to be replaced by values from your output so far.

For the pairwise comparisons, it is a bit tricky as it depends if the variable for the main effect is an independent (between) or repeated (within) measures. If it is independent measures then follow the code from last week's workshop (see \texttt{cohens\_d}).

As we have a repeated design we can use the same code as the \emph{t}-test workshop earlier in term. **One annoying this here is we need to go back and use the original \texttt{mydata} data as this is a rare occasion that wide data is preferred (how annoying, right?!)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cohens\_d}\NormalTok{(mydata}\SpecialCharTok{$}\NormalTok{car, mydata}\SpecialCharTok{$}\NormalTok{bike, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{cohens\_d}\NormalTok{(mydata}\SpecialCharTok{$}\NormalTok{car, mydata}\SpecialCharTok{$}\NormalTok{pedestrian, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{cohens\_d}\NormalTok{(mydata}\SpecialCharTok{$}\NormalTok{pedestrian, mydata}\SpecialCharTok{$}\NormalTok{bike, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

These need to match the three comparisons carried out in exercise 4.

\begin{quote}
\textbf{Question 13: Which pairwise comparison had the largest effect size?} -- choose an answer -- A. Car vs.~Pedestrian B. Bike vs.~Pedestrian C. Car vs.~Bike
\end{quote}

\section{Exercise 7: Evaluating Assumptions}\label{exercise-7-evaluating-assumptions}

We Sphericity was already checker earlier on. As this is a mixed design, we now have two more assumptions to check.

\subsection{Checking Normality}\label{checking-normality}

You have done this before. Same code, providing your ANOVA model is called \texttt{mod}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# testing normality, looking at normal distribution of residuals from the model.}
\NormalTok{residuals }\OtherTok{\textless{}{-}} \FunctionTok{residuals}\NormalTok{(mod) }\CommentTok{\#pulls residuals from the model}
\FunctionTok{qqPlot}\NormalTok{(residuals) }\CommentTok{\#produces a qq{-}plot of residuals}
\FunctionTok{hist}\NormalTok{(residuals, }\AttributeTok{breaks =} \DecValTok{20}\NormalTok{, }\AttributeTok{main =} \StringTok{"Histogram of Residuals"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Residuals"}\NormalTok{, }\AttributeTok{col =} \StringTok{"lightblue"}\NormalTok{) }\CommentTok{\#histogram of residuals}
\FunctionTok{shapiro.test}\NormalTok{(residuals) }\CommentTok{\#Shapiro test for residuals}
\end{Highlighting}
\end{Shaded}

\subsection{Checking Homogeneity of Variance}\label{checking-homogeneity-of-variance}

You should use Levene's test. You've also done this before but for a one-way independent ANOVA.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{leveneTest}\NormalTok{(NULL1 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ NULL2, longd)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Change \texttt{NULL1} to the dependent variable.
\item
  Change \texttt{NULL2} to the independent (between subjects) measures independent variable.
\item
  The third item is the object which contains the data, in this case \texttt{longd} again.
\end{itemize}

Remember, a non-significant \emph{p}-value (\textgreater.05) means the assumption was met.

\section{Exercise 8: Data Visualisation}\label{exercise-8-data-visualisation}

When considering data visualisation options, you should consider ``what are the significant and important findings I want to show my reader?''. Given you have two significant main effects and a non-significant interaction, if you only present a figure showing the interaction, you're not teling the full story.

Use the code below to generate three plots. Take a look at them and interpret what they show.

\subsection{Plot 1}\label{plot-1}

ðŸ“Š Click for Code

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(longd, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ distraction, }\AttributeTok{y =}\NormalTok{ acc)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{, }
               \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }
               \AttributeTok{color =} \StringTok{"black"}\NormalTok{,}
               \AttributeTok{fill =} \FunctionTok{c}\NormalTok{(}\StringTok{"slategray4"}\NormalTok{, }\StringTok{"slategray2"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun.data =}\NormalTok{ mean\_se, }\AttributeTok{geom =} \StringTok{"errorbar"}\NormalTok{, }
               \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{), }\AttributeTok{width =} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Distraction"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Mean Number of Hazards Identified"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"yes"} \OtherTok{=} \StringTok{"Yes"}\NormalTok{, }\StringTok{"no"} \OtherTok{=} \StringTok{"No"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{14}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\subsection{Plot 2}\label{plot-2}

ðŸ“Š Click for Code

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(longd, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ hazard, }\AttributeTok{y =}\NormalTok{ acc)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{, }
               \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }
               \AttributeTok{color =} \StringTok{"black"}\NormalTok{,}
               \AttributeTok{fill =} \FunctionTok{c}\NormalTok{(}\StringTok{"slategray4"}\NormalTok{, }\StringTok{"slategray2"}\NormalTok{, }\StringTok{"darkslategray3"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun.data =}\NormalTok{ mean\_se, }\AttributeTok{geom =} \StringTok{"errorbar"}\NormalTok{, }
               \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{), }\AttributeTok{width =} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Hazard Type"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Mean Hazards Identified"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"car"} \OtherTok{=} \StringTok{"Car"}\NormalTok{, }\StringTok{"bike"} \OtherTok{=} \StringTok{"Bike"}\NormalTok{, }\StringTok{"pedestrian"} \OtherTok{=} \StringTok{"Pedestrian"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{14}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\subsection{Plot 3}\label{plot-3}

ðŸ“Š Click for Code

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p3 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(longd, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ hazard, }\AttributeTok{y =}\NormalTok{ acc, }\AttributeTok{fill =}\NormalTok{ distraction)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun.data =}\NormalTok{ mean\_se, }\AttributeTok{geom =} \StringTok{"errorbar"}\NormalTok{, }
               \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{), }\AttributeTok{width =} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,   }\CommentTok{\# leave this as NULL because APA figures do not use titles.}
    \AttributeTok{x =} \StringTok{"Hazard"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Mean Number of Hazards Identified"}\NormalTok{,}
    \AttributeTok{fill =} \StringTok{"Distraction"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"yes"} \OtherTok{=} \StringTok{"slategray4"}\NormalTok{, }\StringTok{"no"} \OtherTok{=} \StringTok{"slategray2"}\NormalTok{), }
                    \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{, }\StringTok{"No"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"car"} \OtherTok{=} \StringTok{"Car"}\NormalTok{, }\StringTok{"bike"} \OtherTok{=} \StringTok{"Bike"}\NormalTok{, }\StringTok{"pedestrian"} \OtherTok{=} \StringTok{"Pedestrian"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{14}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Once you have run all three, use the code below to present all three at once.
You'll need a new package.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"gridExtra"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(gridExtra)}

\FunctionTok{grid.arrange}\NormalTok{(p1,p2,p3, }\AttributeTok{ncol =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{NOTE}: You will likely need to resize the output panel (bottom right panel) by making it wider so all three plots are visible.

\begin{quote}
\textbf{Question 14: Which plot tells us about the main effect of distraction?} -- choose an answer -- A. Plot 1 (p1) B. Plot 2 (p2) C. Plot 3 (p3)
\end{quote}

\begin{quote}
\textbf{Question 15: Which plot tells us about the main effect of hazard?} -- choose an answer -- A. Plot 1 (p1) B. Plot 2 (p2) C. Plot 3 (p3)
\end{quote}

\begin{quote}
\textbf{Question 16: Which plot tells us about the interaction?} -- choose an answer -- A. Plot 1 (p1) B. Plot 2 (p2) C. Plot 3 (p3)
\end{quote}

\begin{longtable}[]{@{}l@{}}
\toprule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Well Done. You have reached the end of the workshop \\
\end{longtable}

\chapter{Workshop 9: Non-Parametric Statistics}\label{workshop-9-non-parametric-statistics}

\textbf{Aims:}

\begin{itemize}
\tightlist
\item
  Practice importing and wrangling data ready for analysis.
\item
  Practice using non-parametric statistics for a one-way repeated design, including any follow-up analyses.
\end{itemize}

\section{Exercise 1: Import and Prepare Data}\label{exercise-1-import-and-prepare-data}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(rstatix)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"coin"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(coin)}
\end{Highlighting}
\end{Shaded}

Import the data set called \texttt{exercise\_uni.csv}

This is a data set which looked at the average number of hours per week university students engaged in any form of physical exercise, across three time points: before, during, and after university. This is a repeated measures design.

The aim of this study was to determine if levels of physical exercise changed over time.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{view}\NormalTok{(mydata)}
\FunctionTok{names}\NormalTok{(mydata)}
\end{Highlighting}
\end{Shaded}

The data are not in long format. Use the code below to change this changing \texttt{NULL} where necessary. The code below assumes you have saved the original data set as an object called \texttt{mydata}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{longd }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(}\ConstantTok{NULL}\SpecialCharTok{:}\ConstantTok{NULL}\NormalTok{),}
               \AttributeTok{names\_to =} \StringTok{"time"}\NormalTok{,}
               \AttributeTok{values\_to =} \StringTok{"exercise"}\NormalTok{)}
               
\FunctionTok{view}\NormalTok{(longd) }\CommentTok{\#take a look at what the above code has done. nice and long!}
\end{Highlighting}
\end{Shaded}

You should probably code \texttt{time} as a factor, but also reorder the levels. As a standard, where there are multiple levels, RStudio will pop them in alphabetical order. However, our levels have a meaningful order. At the moment alphabetically they are: \texttt{after}, \texttt{before}, \texttt{druing} which is unhelpful.

Change these so that they're in the correct order: \texttt{before}, \texttt{during}, \texttt{after}. Change \texttt{NULL} in the code to do this.

\begin{verbatim}
longd$time <- factor(longd$time, levels = c("NULL", "NULL", "NULL"))
\end{verbatim}

\section{Exercise 2: Descriptive Statistics}\label{exercise-2-descriptive-statistics}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{desc }\OtherTok{\textless{}{-}}\NormalTok{ longd }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(}\ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{median =} \ConstantTok{NULL}\NormalTok{(}\ConstantTok{NULL}\NormalTok{))}

\FunctionTok{view}\NormalTok{(desc)}
\end{Highlighting}
\end{Shaded}

Change \texttt{NULL} in the code above. Remember, as you are using non-parametric statistics you should consider if you want to use the mean or something else\ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(longd, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ time, }\AttributeTok{y =}\NormalTok{ exercise)) }\SpecialCharTok{+}
  \FunctionTok{geom\_violin}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.2}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\section{Exercise 3: Friedman's ANOVA}\label{exercise-3-friedmans-anova}

Run the ANOVA and ask for effect size. Remember to use the formula \texttt{DV\ \textasciitilde{}\ IV\ \textbar{}\ id}. Change \texttt{NULL}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{friedman.test}\NormalTok{(}\ConstantTok{NULL} \SpecialCharTok{\textasciitilde{}} \ConstantTok{NULL} \SpecialCharTok{|} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{data =}\NormalTok{ longd)}
\FunctionTok{friedman\_effsize}\NormalTok{(}\ConstantTok{NULL} \SpecialCharTok{\textasciitilde{}} \ConstantTok{NULL} \SpecialCharTok{|} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{data =}\NormalTok{ longd)}
\end{Highlighting}
\end{Shaded}

Interpret the output. If the main effect is significant, post-hoc tests are needed. Amend the code below by changing \texttt{NULL} so your data set variables are in the correct place.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{longd }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pairwise\_wilcox\_test}\NormalTok{(}
    \ConstantTok{NULL} \SpecialCharTok{\textasciitilde{}} \ConstantTok{NULL}\NormalTok{,}
    \AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{,}
    \AttributeTok{p.adjust.method =} \StringTok{"holm"}\NormalTok{)}
    
\FunctionTok{wilcox\_effsize}\NormalTok{(}\ConstantTok{NULL} \SpecialCharTok{\textasciitilde{}} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{data =}\NormalTok{ longd, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}l@{}}
\toprule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Well Done. You have reached the end of the workshop \\
\end{longtable}

\section{Code for all Four Non-Parametric Tests}\label{code-for-all-four-non-parametric-tests}

The code below is for all four statistics covered in the lecture. These are included below as you might want the code for your year 3 final year project, if you use non-parametric analyses for your project data analysis.

\section{Mann-Whitney U (or Wilcoxon Rank-Sum)}\label{mann-whitney-u-or-wilcoxon-rank-sum}

To use this code you will need to change:

\begin{itemize}
\tightlist
\item
  \texttt{DV} to the dependent variable.
\item
  \texttt{IV} to the independent variable.
\item
  \texttt{DATA} to the name of the object which has your data.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{wilcox.test}\NormalTok{(DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV, }\AttributeTok{data =}\NormalTok{ DATA) }\CommentTok{\# provides W and p statistics}
\FunctionTok{wilcox\_effsize}\NormalTok{(rt }\SpecialCharTok{\textasciitilde{}}\NormalTok{ drink, }\AttributeTok{data =}\NormalTok{ mydata) }\CommentTok{\# provides rank{-}biserial correlation r statistic and magnitude}
\end{Highlighting}
\end{Shaded}

\section{Kruskal-Wallis}\label{kruskal-wallis}

\begin{itemize}
\tightlist
\item
  \texttt{DV} to the dependent variable.
\item
  \texttt{IV} to the independent variable.
\item
  \texttt{DATA} to the name of the object which has your data.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{kruskal.test}\NormalTok{(DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV, }\AttributeTok{data =}\NormalTok{ DATA)}
\FunctionTok{kruskal\_effsize}\NormalTok{(DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV, }\AttributeTok{data =}\NormalTok{ DATA)}

\CommentTok{\#pairwirse comparisons if main effect is signifcant}
\NormalTok{DATA }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pairwise\_wilcox\_test}\NormalTok{(}
\NormalTok{    DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV,}
    \AttributeTok{paired =} \ConstantTok{FALSE}\NormalTok{,}
    \AttributeTok{p.adjust.method =} \StringTok{"holm"}\NormalTok{)}
    
\FunctionTok{wilcox\_effsize}\NormalTok{(DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV, }\AttributeTok{data =}\NormalTok{ DATA) }\CommentTok{\# provides rank{-}biserial correlation r statistic and magnitude}
\end{Highlighting}
\end{Shaded}

\section{Wilcoxon-Signed Rank}\label{wilcoxon-signed-rank}

\begin{itemize}
\tightlist
\item
  \texttt{DV} to the dependent variable.
\item
  \texttt{IV} to the independent variable.
\item
  \texttt{DATA} to the name of the object which has your data.
\end{itemize}

Your data need to be in long format for this analysis, as it is a repeated measures design.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pairwise\_wilcox\_test}\NormalTok{(DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV, }\AttributeTok{data =}\NormalTok{ DATA, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{wilcox\_effsize}\NormalTok{(DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV, }\AttributeTok{data =}\NormalTok{ DATA, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{) }\CommentTok{\# provides rank{-}biserial correlation r statistic and magnitude}
\end{Highlighting}
\end{Shaded}

\section{Friedman's ANOVA}\label{friedmans-anova}

\begin{itemize}
\tightlist
\item
  \texttt{DV} to the dependent variable.
\item
  \texttt{IV} to the independent variable.
\item
  \texttt{DATA} to the name of the object which has your data.
\item
  \texttt{id} should be the name of the \texttt{id} variable (identifier for each participant)
\end{itemize}

Your data need to be in long format for this analysis, as it is a repeated measures design.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{friedman.test}\NormalTok{(DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV }\SpecialCharTok{|}\NormalTok{ id, }\AttributeTok{data =}\NormalTok{ DATA)}
\FunctionTok{friedman\_effsize}\NormalTok{(DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV }\SpecialCharTok{|}\NormalTok{ id, }\AttributeTok{data =}\NormalTok{ DATA)}

\CommentTok{\#pairwirse comparisons if main effect is signifcant}
\NormalTok{DATA }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pairwise\_wilcox\_test}\NormalTok{(}
\NormalTok{    DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV,}
    \AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{,}
    \AttributeTok{p.adjust.method =} \StringTok{"holm"}\NormalTok{)}
\FunctionTok{wilcox\_effsize}\NormalTok{(DV }\SpecialCharTok{\textasciitilde{}}\NormalTok{ IV, }\AttributeTok{data =}\NormalTok{ DATA, }\AttributeTok{paired =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\chapter{Workshop 10: Visualising Data}\label{workshop-10-visualising-data}

\textbf{Aims:}

\begin{itemize}
\tightlist
\item
  Practice working with ggplot() to produce a bar chart for a 2x2 factorial design.
\item
  Explore alternative plots using code for a violin plot and a box plot.
\item
  Practice working with ggplot() to produce a line graph for a data set looking at data over time points.
\item
  Build and interpret a complex snowman plot.
\end{itemize}

\section{Bar Chart}\label{bar-chart}

In this part of the workshop you will work step by step to build a bar chart in order to learn about \texttt{ggplot().}

As covered in lecture \texttt{ggplot()} is a very powerful package that can be used to create all sorts of figures, graphs plots, or data visuals.

As explained in lecture, to build these plots you use layers.

\subsection{Exercise 1.1: Import Data}\label{exercise-1.1-import-data}

Import the \texttt{circadian.csv} data set. The code below assumes it will be called \texttt{mydata}.

In this data set we have two independent variables: drink type and circadian chronotype. Each with two levels. The dependent variable was self-reported ``alertness''. Participants consumed one of the two energy drinks at 9am before reporting their alertness an hour later. They also completed a questionnaire to determine their circadian chronotype.

Ensure any factors are coded as a factor.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata}\SpecialCharTok{$}\NormalTok{circadian }\OtherTok{=} \FunctionTok{factor}\NormalTok{(mydata}\SpecialCharTok{$}\NormalTok{circadian, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"morning"}\NormalTok{, }\StringTok{"evening"}\NormalTok{))}
\NormalTok{mydata}\SpecialCharTok{$}\NormalTok{drink }\OtherTok{=} \FunctionTok{factor}\NormalTok{(mydata}\SpecialCharTok{$}\NormalTok{drink) }\CommentTok{\#turns into a factor}
\end{Highlighting}
\end{Shaded}

Why does the code above have \texttt{levels\ =\ c()} for one of them. This is how we can re-order the levels if needed. R will automatically have these in alphabetical order, however, as morning does indeed come before evening on each day, I will specify the order.

\subsection{Exercise 1.2: Build the Bar Chart}\label{exercise-1.2-build-the-bar-chart}

You will build a bar chart step by step to learn about the different components at each layer of the code.

\begin{itemize}
\tightlist
\item
  Layer 1: Add data and plot aesthetics
\item
  Layers 2 \& 3: Add values and error bars.
\item
  Layer 4: Axis labels
\item
  Layer 5: Factor level labels
\item
  Layer 6: Apply a theme.
\end{itemize}

Here we go\ldots{}

\textbf{Layer 1} Add data and plot aesthetics

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NULL}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Think carefully what you want to appear on the x-axis, the y-axis, and in the legend (called \texttt{fill\ =}). Change \texttt{NULL} with the variable names in \texttt{mydata} (or your data file).

Sometimes it can be helpful to sketch out your figure on paper first before trying to work with the code.

For this example, we are particularly interested in comparing the two energy drinks.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for the solution

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ circadian, }\AttributeTok{y =}\NormalTok{ alert, }\AttributeTok{fill =}\NormalTok{ drink))}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Layer 2} Add values

You have told R where to find the data (in the object called \texttt{mydata}) and you have plotted what should go on the two axes (\texttt{x\ =} and \texttt{y=}) and the figure legend (\texttt{fill\ =}) but now you need to code what values you want to display.

For a bar chart, use the mean.

Remember to use \texttt{+} to add this on to the code above to build the layers.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{,}
            \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{Layer 3} Error bars

Really simple, we will use the standard error.

If you want to instead show +/- 1 standard deviation, use the additional code below instead of this one.

Remember for each layer to add \texttt{+}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun.data =}\NormalTok{ mean\_se, }\AttributeTok{geom =} \StringTok{"errorbar"}\NormalTok{, }
            \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{), }\AttributeTok{width =} \FloatTok{0.25}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for Standard Deviation

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{stat\_summary}\NormalTok{(}
  \AttributeTok{fun.data =} \ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{mean\_sdl}\NormalTok{(x, }\AttributeTok{mult =} \DecValTok{1}\NormalTok{),}
  \AttributeTok{geom =} \StringTok{"errorbar"}\NormalTok{,}
  \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{),}
  \AttributeTok{width =} \FloatTok{0.25}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Layer 4} Axis labels

Decide on appropriate names for both the \texttt{x} and \texttt{y} axes by changing \texttt{NULL}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,   }\CommentTok{\# keep NULL APA figures don\textquotesingle{}t use titles.}
     \AttributeTok{x =} \StringTok{"Circadian Chronotype"}\NormalTok{,  }
     \AttributeTok{y =} \StringTok{"Mean Alertness Score"}\NormalTok{,}
     \AttributeTok{fill =} \StringTok{"Drink"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{Layer 5} Factor level labels

If you look at your figure at the moment, you'll see that ``morning'' and ``evening'' are lowercase. This is the same for the drink types. Let's change this.

Usually we want to keep our data files all lowercase. This is generally good practice because it means we do not need to keep using capital letters when coding.

However, if you look at your figure, you'll see that ``morning'' and ``evening'' are lowercase. This is the same for the drink types. Let's change this.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"redcow"} \OtherTok{=} \StringTok{"slategrey"}\NormalTok{, }\StringTok{"yumster"} \OtherTok{=} \StringTok{"slategray1"}\NormalTok{), }
                    \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Red Cow"}\NormalTok{, }\StringTok{"Yumster"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"morning"} \OtherTok{=} \StringTok{"Morning"}\NormalTok{, }\StringTok{"evening"} \OtherTok{=} \StringTok{"Evening"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\texttt{scale\_fill\_manual}:

\begin{itemize}
\item
  \texttt{values\ =} will allow you to assign colours to each level (if you have a figure legend). 've picked\texttt{slategrey4}and\texttt{slategrey2\textbackslash{}} but there are lots to choose from here: \url{https://r-charts.com/colors/} Try to be sensible when picking colours\ldots{}
\item
  \texttt{labels\ =} will allow you to code what the text says within the legend itself. Here we can add capital letters.
\end{itemize}

\texttt{scale\_x\_discrete}:

\begin{itemize}
\tightlist
\item
  \texttt{labels\ =} will again allow you to code what the text says on the x axis.
\end{itemize}

\textbf{Layer 6} Add a theme

Themes in ggplot allow you to tidy up the figure as a whole. Here you could change the grey background, change the font types or sizes, and a few other things.

The code below does not need tweaking as it is a theme which closely mimics an APA style figure.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{),}
        \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.ticks.x =} \FunctionTok{element\_line}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

Hopefully you should now have the completed figure.

\subsection{Exercise 1.3: Tweaking the Colours}\label{exercise-1.3-tweaking-the-colours}

I know above I did say to be sensible about the colours. However, you might remember some quite specific branding from the two energy drinks.

Change your code from figure above to use the following colours for the two energy drink types.

\begin{itemize}
\tightlist
\item
  For Red Cow use \texttt{"steelblue1"}
\item
  For Yumster use \texttt{"forestgreen"}
\end{itemize}

\subsection{Exercise 1.4: Saving a Plot}\label{exercise-1.4-saving-a-plot}

To save a plot, you can use the \texttt{ggsave()} function.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"NULL.jpg"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Change \texttt{NULL} to a name for your file. All the text should be in quotation marks (e.g., \texttt{ggsave("my\_file.png")}) You can also amend the file type, for example, to save it as a \texttt{.jpg} or \texttt{.png} image file.

Finally, this will then export the most recently created plot directly to your working directory.

Hint: you should do this for the plots you produce today as you will need some of them for the weekly quiz.

\section{Violin Plot}\label{violin-plot}

Have a go at running this code to produce a violin plot.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ circadian, }\AttributeTok{y =}\NormalTok{ alert, }\AttributeTok{fill =}\NormalTok{ drink)) }\SpecialCharTok{+}
  \FunctionTok{geom\_violin}\NormalTok{(}\AttributeTok{trim =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{scale =} \StringTok{"area"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{linewidth =} \FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.8}\NormalTok{, }\AttributeTok{outlier.shape =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,   }\CommentTok{\# keep NULL APA figures don\textquotesingle{}t use titles.}
       \AttributeTok{x =} \StringTok{"Circadian Chronotype"}\NormalTok{,  }
       \AttributeTok{y =} \StringTok{"Mean Alertness Score"}\NormalTok{,}
       \AttributeTok{fill =} \StringTok{"Drink"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"redcow"} \OtherTok{=} \StringTok{"steelblue1"}\NormalTok{, }\StringTok{"yumster"} \OtherTok{=} \StringTok{"forestgreen"}\NormalTok{), }
                    \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Red Cow"}\NormalTok{, }\StringTok{"Yumster"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Morning"}\NormalTok{, }\StringTok{"Afternoon"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{),}
        \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.ticks.x =} \FunctionTok{element\_line}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\section{Box Plot}\label{box-plot}

Have a go at running this code to produce a boxplot plot.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ circadian, }\AttributeTok{y =}\NormalTok{ alert, }\AttributeTok{fill =}\NormalTok{ drink)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \FloatTok{0.2}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,   }\CommentTok{\# keep NULL APA figures don\textquotesingle{}t use titles.}
       \AttributeTok{x =} \StringTok{"Circadian Chronotype"}\NormalTok{,  }
       \AttributeTok{y =} \StringTok{"Mean Alertness Score"}\NormalTok{,}
       \AttributeTok{fill =} \StringTok{"Drink"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"redcow"} \OtherTok{=} \StringTok{"steelblue1"}\NormalTok{, }\StringTok{"yumster"} \OtherTok{=} \StringTok{"forestgreen"}\NormalTok{), }
                    \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Red Cow"}\NormalTok{, }\StringTok{"Yumster"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Morning"}\NormalTok{, }\StringTok{"Afternoon"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{),}
        \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.ticks.x =} \FunctionTok{element\_line}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\section{Line Chart}\label{line-chart}

Import the data set called \texttt{christmas.csv}, save it as an object called \texttt{tree}.

This data contains Christmas tree sales (in millions) in the US for both real and artificial Christmas trees from 2004.

This exercise is just to help you learn to adapt code.

\begin{itemize}
\tightlist
\item
  Layer 1: Add data and plot aesthetics
\item
  Layers 2 \& 3: Add values and line of best fit.
\item
  Layer 4: Labels
\item
  Layer 5: Factor level labels and colours
\item
  Layer 6: Apply a theme.
\end{itemize}

\textbf{Layer 1} Add data and plot aesthetics

Look through the data set so you are aware what to include. Amend the code below to add data and plot the aesthetics.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(NULL1, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ NULL2, }\AttributeTok{y =}\NormalTok{ NULL3, }\AttributeTok{col =}\NormalTok{ NULL4))}
\end{Highlighting}
\end{Shaded}

Use the drop down below if you need a hint\ldots{}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for a hint

\begin{itemize}
\item
  \texttt{NULL1} - what is the name of your object with the data.
\item
  \texttt{NULL2} - what variable should be on the x (horizontal axis). As this is a line graph, try to think carefully what would be most appropriate.
\item
  \texttt{NULL3} - what variable should be in the y (vertical) axis. This is usually a numeric value for most charts.
\item
  \texttt{NULL4} - We can use \texttt{col\ =} to decide if we have factors with multiple levels. We can then later assign these a colour or pattern (e.g.~dash vs.~solid line).
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Layers 2 \& 3} Add values and line of best fit

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
\FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\texttt{geom\_point()} will add the data as points, and \texttt{geom\_smooth()} will give us a line of best fit .

\texttt{method\ =\ "lm} specifies the type of line: ``lm'' means linear model (simple linear regression).

\texttt{se\ =\ FALSE} will turn off a shaded area called a confidence interval around the line.

\textbf{Layer 4} Labels

Run the code below \textbf{before} changing any \texttt{NULL} values. Then look at your plot to see which NULL labels appear on each part of the plot.

Then, update these to give your plot a suitable title* and labels.

*Yes, APA format doesn't make use of titles, but for practice why not have a go at creating one.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"NULL1"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"NULL2"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"NULL3"}\NormalTok{,}
    \AttributeTok{col =} \StringTok{"NULL4"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

ðŸ‘€ Click for the answer

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Real and Artificial Christmas Trees Sold in the US"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Year"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Trees Sold (Millions)"}\NormalTok{,}
    \AttributeTok{col =} \StringTok{"Type of Tree"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\textbf{Layer 5} Factor level labels and colours

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{scale\_colour\_manual}\NormalTok{(}
  \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"Artificial Tree"} \OtherTok{=} \StringTok{"green2"}\NormalTok{, }\StringTok{"Real Tree"} \OtherTok{=} \StringTok{"darkgreen"}\NormalTok{),}
  \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"NULL1"}\NormalTok{, }\StringTok{"NULL2"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Change \texttt{NULL} values to suitable labels for the two tree types.

\textbf{Layer 6} Apply a theme.

AGain, not stricly APA but just to try out different things, keep it simple and apply

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Consider trying different themes. Change \texttt{theme\_bw()} to one of these below to see how it changes the plot. Which is your favourite?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{theme\_bw}\NormalTok{()}

\CommentTok{\#or}
\FunctionTok{theme\_classic}\NormalTok{()}

\CommentTok{\#or}
\FunctionTok{theme\_linedraw}\NormalTok{()}

\CommentTok{\#or}
\FunctionTok{theme\_grey}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

There you go, you now have a perfectly functioning line chart.

\section{Snowman Plot}\label{snowman-plot}

Now for some real serious complicated plotting\ldots{}

\texttt{ggplot()} is really powerful and there are so many things you can do with it.

You'll need these packages.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"ggforce"}\NormalTok{) }\CommentTok{\# you\textquotesingle{}ll need this package if not installed}
\FunctionTok{library}\NormalTok{(ggforce)}
\FunctionTok{library}\NormalTok{(tidyverse) }\CommentTok{\# if not already loaded}
\end{Highlighting}
\end{Shaded}

Copy and paste the code below for the snowman plot\ldots{}
The code is quite long so expand the section below to copy it, and then run it all at once.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

â„ï¸ Click to build a snowman

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{snowman }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{y =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{x =} \DecValTok{0}\NormalTok{, }\AttributeTok{r =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)}
\NormalTok{p }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(snowman) }\SpecialCharTok{+} 
  \FunctionTok{geom\_circle}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x0 =}\NormalTok{ x, }\AttributeTok{y0 =}\NormalTok{ y, }\AttributeTok{r =}\NormalTok{ r)) }\SpecialCharTok{+} 
  \FunctionTok{coord\_fixed}\NormalTok{()}
\NormalTok{snowman }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \DecValTok{0}\NormalTok{, }\AttributeTok{r =} \DecValTok{3}\SpecialCharTok{:}\DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{y =}\NormalTok{(r}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{*{-}}\DecValTok{1}\NormalTok{)}
\NormalTok{p }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(snowman) }\SpecialCharTok{+} 
  \FunctionTok{geom\_circle}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x0 =}\NormalTok{ x, }\AttributeTok{y0 =}\NormalTok{ y, }\AttributeTok{r =}\NormalTok{ r),}
              \AttributeTok{fill =} \StringTok{"white"}\NormalTok{, }
              \AttributeTok{colour =} \StringTok{"lightgrey"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{coord\_fixed}\NormalTok{()}
\NormalTok{face }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\DecValTok{0}\NormalTok{),}
               \AttributeTok{y =} \FunctionTok{c}\NormalTok{(.}\DecValTok{75}\NormalTok{, .}\DecValTok{75}\NormalTok{, }\DecValTok{1}\NormalTok{)}\SpecialCharTok{*{-}}\DecValTok{1}\NormalTok{,}
  \AttributeTok{type =} \FunctionTok{c}\NormalTok{(}\StringTok{"eye"}\NormalTok{, }\StringTok{"eye"}\NormalTok{, }\StringTok{"nose"}\NormalTok{),}
  \AttributeTok{colour =} \FunctionTok{c}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\StringTok{"black"}\NormalTok{, }\StringTok{"coral2"}\NormalTok{))}
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ p }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{data =}\NormalTok{ face, }\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{,}
             \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y, }
                 \AttributeTok{shape =}\NormalTok{ type, }\AttributeTok{colour =} \FunctionTok{I}\NormalTok{(colour)))}
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ p }\SpecialCharTok{+} \FunctionTok{geom\_arc}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x0 =}\NormalTok{ snowman}\SpecialCharTok{$}\NormalTok{x[}\FunctionTok{nrow}\NormalTok{(snowman)], }
               \AttributeTok{y0 =}\NormalTok{ snowman}\SpecialCharTok{$}\NormalTok{y[}\FunctionTok{nrow}\NormalTok{(snowman)], }
               \AttributeTok{start =} \FloatTok{2.2}\NormalTok{, }\AttributeTok{end =} \DecValTok{4}\NormalTok{, }\AttributeTok{r=}\NormalTok{.}\DecValTok{6}\NormalTok{))}
\NormalTok{arms }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{3.5}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{3.4}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{3.2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\FloatTok{3.6}\NormalTok{, }\FloatTok{3.1}\NormalTok{, }\FloatTok{3.5}\NormalTok{, }\FloatTok{3.1}\NormalTok{, }\FloatTok{3.3}\NormalTok{),}
               \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{3.7}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{3.2}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{3.5}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{3.2}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{2.8}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{3.7}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{3.2}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{3.4}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{3.1}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{2.5}\NormalTok{),}
    \AttributeTok{side =} \FunctionTok{c}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\StringTok{"left arm"}\NormalTok{, }\DecValTok{2}\NormalTok{),}
           \FunctionTok{rep}\NormalTok{(}\StringTok{"left finger1"}\NormalTok{, }\DecValTok{2}\NormalTok{),}
           \FunctionTok{rep}\NormalTok{(}\StringTok{"left finger2"}\NormalTok{, }\DecValTok{2}\NormalTok{),}
           \FunctionTok{rep}\NormalTok{(}\StringTok{"right arm"}\NormalTok{, }\DecValTok{2}\NormalTok{),}
           \FunctionTok{rep}\NormalTok{(}\StringTok{"right finger1"}\NormalTok{, }\DecValTok{2}\NormalTok{),}
           \FunctionTok{rep}\NormalTok{(}\StringTok{"right finger2"}\NormalTok{, }\DecValTok{2}\NormalTok{)))}
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ p }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ arms, }
            \AttributeTok{size =} \FloatTok{1.5}\NormalTok{, }\AttributeTok{lineend =} \StringTok{"round"}\NormalTok{,}
            \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y, }\AttributeTok{group =}\NormalTok{ side))}
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ p }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \DecValTok{0}\NormalTok{, }\AttributeTok{y =} \SpecialCharTok{{-}}\DecValTok{3}\SpecialCharTok{:{-}}\DecValTok{5}\NormalTok{), }\AttributeTok{size =} \DecValTok{4}\NormalTok{)}
\NormalTok{tophat }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{0.9}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{0.3}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{0.4}\NormalTok{, }\FloatTok{1.1}\NormalTok{, }\FloatTok{0.8}\NormalTok{, }\FloatTok{1.5}\NormalTok{, }\FloatTok{1.4}\NormalTok{),}
                 \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, .}\DecValTok{25}\NormalTok{, .}\DecValTok{15}\NormalTok{, }\DecValTok{1}\NormalTok{, .}\DecValTok{75}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{0.04}\NormalTok{, }\SpecialCharTok{{-}}\NormalTok{.}\DecValTok{25}\NormalTok{, }\SpecialCharTok{{-}}\NormalTok{.}\DecValTok{5}\NormalTok{),}
                 \AttributeTok{id =} \DecValTok{1}\NormalTok{)}
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ p }\SpecialCharTok{+} \FunctionTok{geom\_polygon}\NormalTok{(}\AttributeTok{data =}\NormalTok{ tophat, }
               \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y, }\AttributeTok{group =}\NormalTok{ id))}
\NormalTok{scarf }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{, }\FloatTok{0.3}\NormalTok{, }\FloatTok{0.4}\NormalTok{, }\FloatTok{0.3}\NormalTok{, }\FloatTok{0.5}\NormalTok{),}
                \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{))}
\NormalTok{p }\OtherTok{\textless{}{-}}\NormalTok{ p }\SpecialCharTok{+} \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ scarf, }\AttributeTok{size =} \DecValTok{3}\NormalTok{, }
            \AttributeTok{lineend=}\StringTok{"round"}\NormalTok{,}
            \AttributeTok{colour =} \StringTok{"firebrick4"}\NormalTok{,}
            \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y))}
\NormalTok{p }\SpecialCharTok{+} \FunctionTok{theme\_void}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"skyblue3"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

This code was adapted from:

DrMowinckels (Dec 11, 2019) Do you wanna build a snowman?. Retrieved from \url{https://drmowinckels.io/blog/2019/do-you-wanna-build-a-snowman/}. DOI: \url{https://www.doi.org/10.5281/zenodo.13273500}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Well Done. You have reached the end of the workshop

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Optional Exercises and Resources for Data Visualisation}\label{optional-exercises-and-resources-for-data-visualisation}

The code below might be useful for your lab report to display a main effect. You'll need the \texttt{tidyverse} package.

\section{Bar Charts (for t-tests, one-way designs, or main effects)}\label{bar-charts-for-t-tests-one-way-designs-or-main-effects}

Download and import the hazard data set for this example. The code below assumes the data has been saved as an object called \texttt{mydata}.

\href{data/earlybird.csv}{Download dataset}.

In this data set \texttt{cc} is the circadian chronotype either morning (lark), neither, or evening (owl) preference. \texttt{slp} is whether the participant reported a calm or disturbed night sleep. \texttt{alert} was the dependent variable and measured morning alertness. Although this is a factorial design, this example will only look at \texttt{cc} independent variable, similar to that of a one-way ANOVA or if you only wanted to report the main effect of circadian chronotype.

This is already in long format, so no need to amend it. However, it is good to check and re-order any factors.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mydata}\SpecialCharTok{$}\NormalTok{cc }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(mydata}\SpecialCharTok{$}\NormalTok{cc, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"lark"}\NormalTok{, }\StringTok{"neither"}\NormalTok{, }\StringTok{"owl"}\NormalTok{))}
\NormalTok{mydata}\SpecialCharTok{$}\NormalTok{slp }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(mydata}\SpecialCharTok{$}\NormalTok{slp)}
\end{Highlighting}
\end{Shaded}

\subsection{Bar Chart}\label{bar-chart-1}

This code will plot mean alertness scores for the three circadian chronotype groups \texttt{cc}, ignoring sleep quality \texttt{slp}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cc, }\AttributeTok{y =}\NormalTok{ alert)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{,}
               \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{,}
               \AttributeTok{fill =} \StringTok{"steelblue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun.data =}\NormalTok{ mean\_se, }\AttributeTok{geom =} \StringTok{"errorbar"}\NormalTok{, }
               \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{), }\AttributeTok{width =} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,   }\CommentTok{\# keep NULL APA figures don\textquotesingle{}t use titles.}
       \AttributeTok{x =} \StringTok{"Circadian Chronotype"}\NormalTok{,  }
       \AttributeTok{y =} \StringTok{"Mean Alertness Score"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Lark"}\NormalTok{, }\StringTok{"Neither"}\NormalTok{, }\StringTok{"Owl"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{linewidth =} \DecValTok{1}\NormalTok{),}
        \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.ticks.x =} \FunctionTok{element\_line}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\subsection{Violin Plot}\label{violin-plot-1}

Same data set, just a different way to show the three groups.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cc, }\AttributeTok{y =}\NormalTok{ alert)) }\SpecialCharTok{+}
  \FunctionTok{geom\_violin}\NormalTok{(}\AttributeTok{trim =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{scale =} \StringTok{"area"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{linewidth =} \FloatTok{0.1}\NormalTok{, }\AttributeTok{fill =} \StringTok{"steelblue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.8}\NormalTok{, }\AttributeTok{outlier.shape =} \DecValTok{1}\NormalTok{,}
               \AttributeTok{fill =} \StringTok{"steelblue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,   }\CommentTok{\# keep NULL APA figures don\textquotesingle{}t use titles.}
       \AttributeTok{x =} \StringTok{"Circadian Chronotype"}\NormalTok{,  }
       \AttributeTok{y =} \StringTok{"Mean Alertness Score"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Lark"}\NormalTok{, }\StringTok{"Neither"}\NormalTok{, }\StringTok{"Owl"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{linewidth =} \DecValTok{1}\NormalTok{),}
        \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.ticks.x =} \FunctionTok{element\_line}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\subsection{Box Plot}\label{box-plot-1}

Same data set, just a different way to show the three groups. All you'll notice here is the \texttt{geom\_violin()} function has been removed, because a box plot is essentially a violn plot but without the density information.

The width for the boxplot has also increased a little too.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cc, }\AttributeTok{y =}\NormalTok{ alert)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.8}\NormalTok{, }\AttributeTok{outlier.shape =} \DecValTok{1}\NormalTok{,}
               \AttributeTok{fill =} \StringTok{"steelblue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,   }\CommentTok{\# keep NULL APA figures don\textquotesingle{}t use titles.}
       \AttributeTok{x =} \StringTok{"Circadian Chronotype"}\NormalTok{,  }
       \AttributeTok{y =} \StringTok{"Mean Alertness Score"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Morning"}\NormalTok{, }\StringTok{"Neither"}\NormalTok{, }\StringTok{"Evening"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{linewidth =} \DecValTok{1}\NormalTok{),}
        \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.ticks.x =} \FunctionTok{element\_line}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

If you have only two levels, this code will still work! You just need to remove the third label in \texttt{scale\_x\_discrete()} when you change the labels to match your data set. A bar chart example is below for an example using sleep qualit: calm vs.~disturbed.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mydata, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ slp, }\AttributeTok{y =}\NormalTok{ alert)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{,}
               \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }\AttributeTok{color =} \StringTok{"black"}\NormalTok{,}
               \AttributeTok{fill =} \StringTok{"steelblue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun.data =}\NormalTok{ mean\_se, }\AttributeTok{geom =} \StringTok{"errorbar"}\NormalTok{, }
               \AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(}\FloatTok{0.9}\NormalTok{), }\AttributeTok{width =} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \ConstantTok{NULL}\NormalTok{,   }\CommentTok{\# keep NULL APA figures don\textquotesingle{}t use titles.}
       \AttributeTok{x =} \StringTok{"Sleep Quality"}\NormalTok{,  }
       \AttributeTok{y =} \StringTok{"Mean Alertness Score"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Calm"}\NormalTok{, }\StringTok{"Disturbed"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{12}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{panel.grid.major =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{panel.border =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{linewidth =} \DecValTok{1}\NormalTok{),}
        \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{axis.ticks.x =} \FunctionTok{element\_line}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\chapter{Workshop 14: Questionnaire Data}\label{workshop-14-questionnaire-data}

\textbf{Aims:}

\begin{itemize}
\tightlist
\item
  To practice working with questionnaire data in preparation for data analysis (e.g., the process sometimes called data wrangling or ``data cleaning'').
\end{itemize}

\section{\texorpdfstring{\textbf{Tasks}}{Tasks}}\label{tasks}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Work in excel to remove any rows and columns that are not needed.
\item
  Remove participants who did not complete the study properly.
\item
  Check for any unusual responses.
\item
  Clean the data file variable names.
\item
  Check for missing responses across each participant.
\item
  Re-code any factor/categorical variables.
\item
  Reverse code any negative items.
\item
  Calculate the mean scores for the two questionnaires.
\item
  Produce basic descriptive statistics for each questionnaire.
\end{enumerate}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{\texorpdfstring{\textbf{1.Work in excel to remove any rows and columns that are not needed}}{1.Work in excel to remove any rows and columns that are not needed}}\label{work-in-excel-to-remove-any-rows-and-columns-that-are-not-needed}

Open the \texttt{anxiety\_procrastination.csv} file (which can be found on Moodle).

This file contains data from participants who completed two questionnaires.
The first was an academic anxiety questionnaire from Cassady et al.~(2019) and the second was the general procrastination scale (short form) from Sirios et al.~(2019).
Participants were also asked their age and if they were a current UK university student.

Have a look at the excel file and make sure you understand what each column shows.

\begin{itemize}
\tightlist
\item
  Column \texttt{C} includes progress data for the online study (\% completed).
\item
  Column \texttt{E} tells us if a participant completed the online study (1 = Yes, 0 = No).
\item
  Column \texttt{F} or \texttt{Q1\ age} tells us the participant age.
\item
  Column \texttt{G} or \texttt{Q2\ uni} tells us if the participant is a current UK university student (1 = No, 2 = Yes).
\item
  Columns \texttt{H} to \texttt{R} are the Likert responses to questions on the academic anxiety scale (scale 1 - 5).
\item
  Columns \texttt{S} to \texttt{AA} are the Likert responses to questions on the general procrastination scale (scale 1 - 5).
\end{itemize}

We need to remove any redundant columns or rows in the data file.
This means any columns or rows which we don't need for the analysis.

\begin{itemize}
\item
  Remove columns \texttt{A} and \texttt{B}.

  -\textbf{Why?} This just contains the start and end date/time for the participant and we do not need the analysis.
\item
  Remove rows \texttt{2} and \texttt{3}.

  -\textbf{Why?} These contain meta-data in the file and we do not need them for the analysis.
\end{itemize}

To remove the column or row, click on the letter or number and right click then press \texttt{delete}

\includegraphics[width=6.78125in,height=\textheight,keepaspectratio]{images/excel1.jpg}

\section{\texorpdfstring{\textbf{2. Remove participants who did not complete the study properly}}{2. Remove participants who did not complete the study properly}}\label{remove-participants-who-did-not-complete-the-study-properly}

In excel we can sort the column which shows participant progress.
Click on this column (now column \texttt{A}) and sort it.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Click on \texttt{A}
\end{enumerate}

\pandocbounded{\includegraphics[keepaspectratio]{images/excel2.jpg}}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Click the \texttt{Data} tab.
\end{enumerate}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Click the \texttt{Sort\ Smallest\ to\ Largest} button.
\end{enumerate}

\pandocbounded{\includegraphics[keepaspectratio]{images/excel3.jpg}}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Click sort with \texttt{expand\ the\ selection} selected.
\end{enumerate}

\pandocbounded{\includegraphics[keepaspectratio]{images/excel4.jpg}}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  Delete any rows of participants who did not complete 100\% of the study. Make a note on how many there were as you would want to report this in your lab report.
\end{enumerate}

\section{\texorpdfstring{\textbf{3. Check for any unusual responses}}{3. Check for any unusual responses}}\label{check-for-any-unusual-responses}

Look at the participant responses.
What do you notice in the \texttt{Q1\ age} column?
Make any changes to the data file to make sure all of the ages are in the same format.

Hint

One of the participants has entered the age as \texttt{19\ years}.
Just change this so it says \texttt{19}

\textbf{Once you have done this, save the excel file as a .csv file called \texttt{anxiety\_procrastination2} and save it somewhere you can easily find it. You will need to save it in your RStudio working directory (see next step!)}

\section{\texorpdfstring{\textbf{4. Clean the data file variable names}}{4. Clean the data file variable names}}\label{clean-the-data-file-variable-names}

Now we have tidying things up in excel, it is time to move over to RStudio.

Load the following libraries, set your working directory, and import the data file.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"janitor"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"psych"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(janitor)}
\FunctionTok{library}\NormalTok{(psych)}

\NormalTok{mydata }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"anxiety\_procrastination2.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

This next bit of code will tidy up our data file in RStudio.
We will also create a new object to work with called \texttt{clean\_mydata}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# clean\_names will:}
\CommentTok{\#(1) change any capital letters to lowercase, }
\CommentTok{\#(2) remove any spaces and replace with an underscore,}

\NormalTok{clean\_mydata }\OtherTok{\textless{}{-}}\NormalTok{ mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{clean\_names}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\section{\texorpdfstring{\textbf{5. Check for missing responses across each participant}}{5. Check for missing responses across each participant}}\label{check-for-missing-responses-across-each-participant}

Sometimes a participant might accidentally miss a question.
We need to check for this to see how many participants might have missing data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clean\_mydata }\OtherTok{\textless{}{-}}\NormalTok{ clean\_mydata }\SpecialCharTok{\%\textgreater{}\%}               \CommentTok{\#this will make sure a new column is added.}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{missing\_count =} \FunctionTok{rowSums}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(.)))    }\CommentTok{\#this will count up the missing responses.}

\FunctionTok{view}\NormalTok{(clean\_mydata)}
\end{Highlighting}
\end{Shaded}

When you \texttt{view} the data it will open in a new tab.
Scroll to the very end and you'll see there is a new column called \texttt{missing\_count}.
What has happened?
The code above created a new column with the sum of the total number of missing responses.

\textbf{How many participants had missing data?}

\textbf{How many responses did they each miss?}

Because the number of missing responses is quite low we can move on.
But if you have a participant who has missed more than 25\% of their responses, you might consider removing them from the data file.

\section{\texorpdfstring{\textbf{6. Re-code any factor/categorical variables}}{6. Re-code any factor/categorical variables}}\label{re-code-any-factorcategorical-variables}

There is one categorical variable.
\texttt{q2\_uni} is a \texttt{No} and \texttt{Yes} question (``Are you a current UK University student?'')

Run this code to re-code the variable:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clean\_mydata}\SpecialCharTok{$}\NormalTok{q2\_uni }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(clean\_mydata}\SpecialCharTok{$}\NormalTok{q2\_uni)}
\end{Highlighting}
\end{Shaded}

This code will take the \texttt{q2\_uni} variable and set it as \texttt{factor}.

\section{\texorpdfstring{\textbf{7. Reverse code any negative items}}{7. Reverse code any negative items}}\label{reverse-code-any-negative-items}

The general procrastination scale has three reverse coded items:

\begin{itemize}
\tightlist
\item
  \texttt{q5\_3}
\item
  \texttt{q5\_5}
\item
  \texttt{q5\_6}
\end{itemize}

We need to reverse code these so that the Likert scores are swapped.
This means:

\texttt{5} becomes a \texttt{1}

\texttt{4} becomes a \texttt{2}

\texttt{3} stays as a \texttt{3}

\texttt{2} becomes a \texttt{4}

\texttt{1} becomes a \texttt{5}

If you are unsure what is meant by a negative or reverse coded item, check the lecture slides.

Run the following code:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# we need to reverse code 3 items for the procrastination questionnaire}
\NormalTok{clean\_mydata}\SpecialCharTok{$}\NormalTok{q5\_3 }\OtherTok{\textless{}{-}} \DecValTok{6} \SpecialCharTok{{-}}\NormalTok{ clean\_mydata}\SpecialCharTok{$}\NormalTok{q5\_3}
\NormalTok{clean\_mydata}\SpecialCharTok{$}\NormalTok{q5\_5 }\OtherTok{\textless{}{-}} \DecValTok{6} \SpecialCharTok{{-}}\NormalTok{ clean\_mydata}\SpecialCharTok{$}\NormalTok{q5\_5}
\NormalTok{clean\_mydata}\SpecialCharTok{$}\NormalTok{q5\_6 }\OtherTok{\textless{}{-}} \DecValTok{6} \SpecialCharTok{{-}}\NormalTok{ clean\_mydata}\SpecialCharTok{$}\NormalTok{q5\_6}

\CommentTok{\# we use the number 6 because there were 5 response options}
\CommentTok{\# if you had a 7 point Likert scale, this should say 8.}
\CommentTok{\# if you had a 9 point Likert scale, this would say 10.}
\CommentTok{\#change the number so it is one more than the number of Likert options.}
\end{Highlighting}
\end{Shaded}

\section{\texorpdfstring{\textbf{8. Calculate the mean scores for the two questionnaires}}{8. Calculate the mean scores for the two questionnaires}}\label{calculate-the-mean-scores-for-the-two-questionnaires}

At the moment we have a cleaned data file with all of the individual question responses.
However, for each participant we need a \texttt{mean} score for each questionnaire/scale.

For each participant we need:

\begin{itemize}
\item
  The overall (\texttt{mean}) academic anxiety questionnaire score.
\item
  The overall (\texttt{mean}) procrastination questionnaire score.
\end{itemize}

We can do this and create new variables for these means using the code below.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select and calculate the anxiety scale score}
\NormalTok{clean\_mydata }\OtherTok{\textless{}{-}}\NormalTok{ clean\_mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{anxiety =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{select}\NormalTok{(., }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"q4\_"}\NormalTok{)), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}

\CommentTok{\# Select and calculate the procrastination scale score}
\NormalTok{clean\_mydata }\OtherTok{\textless{}{-}}\NormalTok{ clean\_mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{procrastination =} \FunctionTok{rowMeans}\NormalTok{(}\FunctionTok{select}\NormalTok{(., }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"q5\_"}\NormalTok{)), }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Let's explain this code bit by bit so you can adapt it again in the future:

\texttt{clean\_mydata\ \textless{}-\ clean\_mydata\ \%\textgreater{}\%} to specify which data file to create the new column.

\texttt{mutate()} will add the new column.

\texttt{anxiety\ =} is what you want to call the new column.

\texttt{rowMeans} will calculate the means across items/questions.

\texttt{select} is so we will only do this for a certain number of items.

\texttt{starts\_with("q4\_")} is so any variable that begins with \texttt{q4\_} is counted (e.g., \texttt{q4\_1} through to \texttt{q4\_11}).

\texttt{na.rm\ =\ TRUE} is important as it will tell R to ignore any missing values when calculating the mean.

\section{\texorpdfstring{\textbf{9. Produce basic descriptive statistics for each questionnaire}}{9. Produce basic descriptive statistics for each questionnaire}}\label{produce-basic-descriptive-statistics-for-each-questionnaire}

If you view your data file, you should see at the very end (final two columns) you should have the mean anxiety and procrastination scores for each participant.
To view the data file, just run:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select and calculate the anxiety scale score}
\FunctionTok{view}\NormalTok{(clean\_mydata)}
\end{Highlighting}
\end{Shaded}

Across our sample, let's just finish by looking at some descriptive statistics.

Run the following code and looks through and interpret the output.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clean\_mydata }\SpecialCharTok{\%\textgreater{}\%}                                     \CommentTok{\# which data file }
  \FunctionTok{select}\NormalTok{(q1\_age, anxiety, procrastination) }\SpecialCharTok{\%\textgreater{}\%}       \CommentTok{\# select what variables to include}
  \FunctionTok{describe}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}                                     \CommentTok{\# describe the data}
  \FunctionTok{select}\NormalTok{(n, mean, sd, se, min, max)                  }\CommentTok{\# describe() will give us some stats}

\CommentTok{\# optional: try removing the first select() function from the code and see what happens}
\NormalTok{clean\_mydata }\SpecialCharTok{\%\textgreater{}\%}                                     \CommentTok{\# which data file }
  \FunctionTok{describe}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}                                     \CommentTok{\# describe the data}
  \FunctionTok{select}\NormalTok{(n, mean, sd, se, min, max)                  }\CommentTok{\# describe() will give us some stats}

\CommentTok{\#hopefully you will see why we used select() as otherwise it will give us values for every single question.}
\CommentTok{\#it might be useful to look at every single question, but for today we just wanted the mean values for the questionnaires.}
\end{Highlighting}
\end{Shaded}

\section{\texorpdfstring{\textbf{10. Optional Exercise}}{10. Optional Exercise}}\label{optional-exercise}

Working more with data:

\subsection{\texorpdfstring{\textbf{Optional Exercise One}}{Optional Exercise One}}\label{optional-exercise-one}

\texttt{q2\_uni} asks participants ``Are you a current UK University student?''.
Let's say our inclusion criteria stated that we want to only use data from current university students, we then need to filter out anyone who answered No.
No = \texttt{1} and Yes = \texttt{2} for this variable.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clean\_mydata }\OtherTok{\textless{}{-}}\NormalTok{ clean\_mydata }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(q2\_uni }\SpecialCharTok{==} \DecValTok{2}\NormalTok{)}

\CommentTok{\#filter(q2\_uni ==2) will include ONLY participants who }
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Well Done.
You have reached the end of the workshop

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\bibliography{book.bib,packages.bib}

\end{document}
