<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Workshop 10: Visualising Data | PS2010 Workshop Code Book</title>
<meta name="author" content="Luke Kendrick">
<meta name="generator" content="bookdown 0.45 with bs4_book()">
<meta property="og:title" content="Chapter 10 Workshop 10: Visualising Data | PS2010 Workshop Code Book">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Workshop 10: Visualising Data | PS2010 Workshop Code Book">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="Aims: Practice working with ggplot() to produce a bar chart for a 2x2 factorial design. Explore alternative plots using code for a violin plot and a box plot. Practice working with ggplot() to...">
<meta property="og:description" content="Aims: Practice working with ggplot() to produce a bar chart for a 2x2 factorial design. Explore alternative plots using code for a violin plot and a box plot. Practice working with ggplot() to...">
<meta name="twitter:description" content="Aims: Practice working with ggplot() to produce a bar chart for a 2x2 factorial design. Explore alternative plots using code for a violin plot and a box plot. Practice working with ggplot() to...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">PS2010 Workshop Code Book</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="workshop-1-data-handling-skills.html"><span class="header-section-number">1</span> Workshop 1: Data Handling Skills</a></li>
<li><a class="" href="workshop-2-summarising-and-describing-data.html"><span class="header-section-number">2</span> Workshop 2: Summarising and Describing Data</a></li>
<li><a class="" href="workshop-3-t-tests.html"><span class="header-section-number">3</span> Workshop 3: t-tests</a></li>
<li><a class="" href="workshop-4-one-way-anova-model-designs-assumptions.html"><span class="header-section-number">4</span> Workshop 4: One-Way ANOVA (Model, Designs, Assumptions)</a></li>
<li><a class="" href="workshop-5-one-way-anova-post-hocs-contrasts-write-up.html"><span class="header-section-number">5</span> Workshop 5: One-Way ANOVA (Post-hocs, Contrasts, Write-up)</a></li>
<li><a class="" href="workshop-6-factorial-anova-factorial-designs-and-an-interactions.html"><span class="header-section-number">6</span> Workshop 6: Factorial ANOVA: Factorial Designs and an Interactions</a></li>
<li><a class="" href="workshop-7-factorial-anova-different-designs-and-assumptions.html"><span class="header-section-number">7</span> Workshop 7: Factorial ANOVA: Different Designs and Assumptions</a></li>
<li><a class="" href="workshop-8-factorial-anova-mixed-design-factorial-anova.html"><span class="header-section-number">8</span> Workshop 8: Factorial ANOVA: Mixed Design Factorial ANOVA</a></li>
<li><a class="" href="workshop-9-non-parametric-statistics.html"><span class="header-section-number">9</span> Workshop 9: Non-Parametric Statistics</a></li>
<li><a class="active" href="workshop-10-visualising-data.html"><span class="header-section-number">10</span> Workshop 10: Visualising Data</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="workshop-10-visualising-data" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Workshop 10: Visualising Data<a class="anchor" aria-label="anchor" href="#workshop-10-visualising-data"><i class="fas fa-link"></i></a>
</h1>
<p><strong>Aims:</strong></p>
<ul>
<li>Practice working with ggplot() to produce a bar chart for a 2x2 factorial design.</li>
<li>Explore alternative plots using code for a violin plot and a box plot.</li>
<li>Practice working with ggplot() to produce a line graph for a data set looking at data over time points.</li>
<li>Build and interpret a complex snowman plot.</li>
</ul>
<div id="bar-chart" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Bar Chart<a class="anchor" aria-label="anchor" href="#bar-chart"><i class="fas fa-link"></i></a>
</h2>
<p>In this part of the workshop you will work step by step to build a bar chart in order to learn about <code>ggplot().</code></p>
<p>As covered in lecture <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> is a very powerful package that can be used to create all sorts of figures, graphs plots, or data visuals.</p>
<p>As explained in lecture, to build these plots you use layers.</p>
<div id="exercise-1.1-import-data" class="section level3" number="10.1.1">
<h3>
<span class="header-section-number">10.1.1</span> Exercise 1.1: Import Data<a class="anchor" aria-label="anchor" href="#exercise-1.1-import-data"><i class="fas fa-link"></i></a>
</h3>
<p>Import the <code>circadian.csv</code> data set. The code below assumes it will be called <code>mydata</code>.</p>
<p>In this data set we have two independent variables: drink type and circadian chronotype. Each with two levels. The dependent variable was self-reported ‚Äúalertness‚Äù. Participants consumed one of the two energy drinks at 9am before reporting their alertness an hour later. They also completed a questionnaire to determine their circadian chronotype.</p>
<p>Ensure any factors are coded as a factor.</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">circadian</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">circadian</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"morning"</span>, <span class="st">"evening"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">drink</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">drink</span><span class="op">)</span> <span class="co">#turns into a factor</span></span></code></pre></div>
<p>Why does the code above have <code>levels = c()</code> for one of them. This is how we can re-order the levels if needed. R will automatically have these in alphabetical order, however, as morning does indeed come before evening on each day, I will specify the order.</p>
</div>
<div id="exercise-1.2-build-the-bar-chart" class="section level3" number="10.1.2">
<h3>
<span class="header-section-number">10.1.2</span> Exercise 1.2: Build the Bar Chart<a class="anchor" aria-label="anchor" href="#exercise-1.2-build-the-bar-chart"><i class="fas fa-link"></i></a>
</h3>
<p>You will build a bar chart step by step to learn about the different components at each layer of the code.</p>
<ul>
<li>Layer 1: Add data and plot aesthetics</li>
<li>Layers 2 &amp; 3: Add values and error bars.</li>
<li>Layer 4: Axis labels</li>
<li>Layer 5: Factor level labels</li>
<li>Layer 6: Apply a theme.</li>
</ul>
<p>Here we go‚Ä¶</p>
<p><strong>Layer 1</strong> Add data and plot aesthetics</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Think carefully what you want to appear on the x-axis, the y-axis, and in the legend (called <code>fill =</code>). Change <code>NULL</code> with the variable names in <code>mydata</code> (or your data file).</p>
<p>Sometimes it can be helpful to sketch out your figure on paper first before trying to work with the code.</p>
<p>For this example, we are particularly interested in comparing the two energy drinks.</p>
<hr>
<details><summary>
üëÄ Click for the solution
</summary><div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">circadian</span>, y <span class="op">=</span> <span class="va">alert</span>, fill <span class="op">=</span> <span class="va">drink</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><hr>
<p><strong>Layer 2</strong> Add values</p>
<p>You have told R where to find the data (in the object called <code>mydata</code>) and you have plotted what should go on the two axes (<code>x =</code> and <code>y=</code>) and the figure legend (<code>fill =</code>) but now you need to code what values you want to display.</p>
<p>For a bar chart, use the mean.</p>
<p>Remember to use <code>+</code> to add this on to the code above to build the layers.</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>,</span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Layer 3</strong> Error bars</p>
<p>Really simple, we will use the standard error.</p>
<p>If you want to instead show +/- 1 standard deviation, use the additional code below instead of this one.</p>
<p>Remember for each layer to add <code>+</code></p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, </span>
<span>            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> </span></code></pre></div>
<hr>
<details><summary>
üëÄ Click for Standard Deviation
</summary><div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span></span>
<span>  fun.data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/hmisc.html">mean_sdl</a></span><span class="op">(</span><span class="va">x</span>, mult <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>  position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></code></pre></div>
</details><hr>
<p><strong>Layer 4</strong> Axis labels</p>
<p>Decide on appropriate names for both the <code>x</code> and <code>y</code> axes by changing <code>NULL</code>.</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span>,   <span class="co"># keep NULL APA figures don't use titles.</span></span>
<span>     x <span class="op">=</span> <span class="st">"Circadian Chronotype"</span>,  </span>
<span>     y <span class="op">=</span> <span class="st">"Mean Alertness Score"</span>,</span>
<span>     fill <span class="op">=</span> <span class="st">"Drink"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Layer 5</strong> Factor level labels</p>
<p>If you look at your figure at the moment, you‚Äôll see that ‚Äúmorning‚Äù and ‚Äúevening‚Äù are lowercase. This is the same for the drink types. Let‚Äôs change this.</p>
<p>Usually we want to keep our data files all lowercase. This is generally good practice because it means we do not need to keep using capital letters when coding.</p>
<p>However, if you look at your figure, you‚Äôll see that ‚Äúmorning‚Äù and ‚Äúevening‚Äù are lowercase. This is the same for the drink types. Let‚Äôs change this.</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"redcow"</span> <span class="op">=</span> <span class="st">"slategrey"</span>, <span class="st">"yumster"</span> <span class="op">=</span> <span class="st">"slategray1"</span><span class="op">)</span>, </span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Red Cow"</span>, <span class="st">"Yumster"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"morning"</span> <span class="op">=</span> <span class="st">"Morning"</span>, <span class="st">"evening"</span> <span class="op">=</span> <span class="st">"Evening"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><code>scale_fill_manual</code>:</p>
<ul>
<li><p><code>values =</code> will allow you to assign colours to each level (if you have a figure legend). ‚Äôve picked<code>slategrey4</code>and<code>slategrey2\</code> but there are lots to choose from here: <a href="https://r-charts.com/colors/" class="uri">https://r-charts.com/colors/</a> Try to be sensible when picking colours‚Ä¶</p></li>
<li><p><code>labels =</code> will allow you to code what the text says within the legend itself. Here we can add capital letters.</p></li>
</ul>
<p><code>scale_x_discrete</code>:</p>
<ul>
<li>
<code>labels =</code> will again allow you to code what the text says on the x axis.</li>
</ul>
<p><strong>Layer 6</strong> Add a theme</p>
<p>Themes in ggplot allow you to tidy up the figure as a whole. Here you could change the grey background, change the font types or sizes, and a few other things.</p>
<p>The code below does not need tweaking as it is a theme which closely mimics an APA style figure.</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Hopefully you should now have the completed figure.</p>
</div>
<div id="exercise-1.3-tweaking-the-colours" class="section level3" number="10.1.3">
<h3>
<span class="header-section-number">10.1.3</span> Exercise 1.3: Tweaking the Colours<a class="anchor" aria-label="anchor" href="#exercise-1.3-tweaking-the-colours"><i class="fas fa-link"></i></a>
</h3>
<p>I know above I did say to be sensible about the colours. However, you might remember some quite specific branding from the two energy drinks.</p>
<p>Change your code from figure above to use the following colours for the two energy drink types.</p>
<ul>
<li>For Red Cow use <code>"steelblue1"</code>
</li>
<li>For Yumster use <code>"forestgreen"</code>
</li>
</ul>
</div>
<div id="exercise-1.4-saving-a-plot" class="section level3" number="10.1.4">
<h3>
<span class="header-section-number">10.1.4</span> Exercise 1.4: Saving a Plot<a class="anchor" aria-label="anchor" href="#exercise-1.4-saving-a-plot"><i class="fas fa-link"></i></a>
</h3>
<p>To save a plot, you can use the <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> function.</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"NULL.jpg"</span><span class="op">)</span></span></code></pre></div>
<p>Change <code>NULL</code> to a name for your file. All the text should be in quotation marks (e.g., <code>ggsave("my_file.png")</code>) You can also amend the file type, for example, to save it as a <code>.jpg</code> or <code>.png</code> image file.</p>
<p>Finally, this will then export the most recently created plot directly to your working directory.</p>
<p>Hint: you should do this for the plots you produce today as you will need some of them for the weekly quiz.</p>
</div>
</div>
<div id="violin-plot" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Violin Plot<a class="anchor" aria-label="anchor" href="#violin-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Have a go at running this code to produce a violin plot.</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">circadian</span>, y <span class="op">=</span> <span class="va">alert</span>, fill <span class="op">=</span> <span class="va">drink</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>trim <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="st">"area"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, outlier.shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span>,   <span class="co"># keep NULL APA figures don't use titles.</span></span>
<span>       x <span class="op">=</span> <span class="st">"Circadian Chronotype"</span>,  </span>
<span>       y <span class="op">=</span> <span class="st">"Mean Alertness Score"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Drink"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"redcow"</span> <span class="op">=</span> <span class="st">"steelblue1"</span>, <span class="st">"yumster"</span> <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span>, </span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Red Cow"</span>, <span class="st">"Yumster"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Morning"</span>, <span class="st">"Afternoon"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="box-plot" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Box Plot<a class="anchor" aria-label="anchor" href="#box-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Have a go at running this code to produce a boxplot plot.</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">circadian</span>, y <span class="op">=</span> <span class="va">alert</span>, fill <span class="op">=</span> <span class="va">drink</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span>,   <span class="co"># keep NULL APA figures don't use titles.</span></span>
<span>       x <span class="op">=</span> <span class="st">"Circadian Chronotype"</span>,  </span>
<span>       y <span class="op">=</span> <span class="st">"Mean Alertness Score"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Drink"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"redcow"</span> <span class="op">=</span> <span class="st">"steelblue1"</span>, <span class="st">"yumster"</span> <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span>, </span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Red Cow"</span>, <span class="st">"Yumster"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Morning"</span>, <span class="st">"Afternoon"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="line-chart" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Line Chart<a class="anchor" aria-label="anchor" href="#line-chart"><i class="fas fa-link"></i></a>
</h2>
<p>Import the data set called <code>christmas.csv</code>, save it as an object called <code>tree</code>.</p>
<p>This data contains Christmas tree sales (in millions) in the US for both real and artificial Christmas trees from 2004.</p>
<p>This exercise is just to help you learn to adapt code.</p>
<ul>
<li>Layer 1: Add data and plot aesthetics</li>
<li>Layers 2 &amp; 3: Add values and line of best fit.</li>
<li>Layer 4: Labels</li>
<li>Layer 5: Factor level labels and colours</li>
<li>Layer 6: Apply a theme.</li>
</ul>
<p><strong>Layer 1</strong> Add data and plot aesthetics</p>
<p>Look through the data set so you are aware what to include. Amend the code below to add data and plot the aesthetics.</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">NULL1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NULL2</span>, y <span class="op">=</span> <span class="va">NULL3</span>, col <span class="op">=</span> <span class="va">NULL4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Use the drop down below if you need a hint‚Ä¶</p>
<hr>
<details><summary>
üëÄ Click for a hint
</summary><ul>
<li><p><code>NULL1</code> - what is the name of your object with the data.</p></li>
<li><p><code>NULL2</code> - what variable should be on the x (horizontal axis). As this is a line graph, try to think carefully what would be most appropriate.</p></li>
<li><p><code>NULL3</code> - what variable should be in the y (vertical) axis. This is usually a numeric value for most charts.</p></li>
<li><p><code>NULL4</code> - We can use <code>col =</code> to decide if we have factors with multiple levels. We can then later assign these a colour or pattern (e.g.¬†dash vs.¬†solid line).</p></li>
</ul></details><hr>
<p><strong>Layers 2 &amp; 3</strong> Add values and line of best fit</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> will add the data as points, and <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> will give us a line of best fit .</p>
<p><code>method = "lm</code> specifies the type of line: ‚Äúlm‚Äù means linear model (simple linear regression).</p>
<p><code>se = FALSE</code> will turn off a shaded area called a confidence interval around the line.</p>
<p><strong>Layer 4</strong> Labels</p>
<p>Run the code below <strong>before</strong> changing any <code>NULL</code> values. Then look at your plot to see which NULL labels appear on each part of the plot.</p>
<p>Then, update these to give your plot a suitable title* and labels.</p>
<p>*Yes, APA format doesn‚Äôt make use of titles, but for practice why not have a go at creating one.</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"NULL1"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"NULL2"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"NULL3"</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"NULL4"</span><span class="op">)</span> </span></code></pre></div>
<hr>
<details><summary>
üëÄ Click for the answer
</summary><div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Real and Artificial Christmas Trees Sold in the US"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Trees Sold (Millions)"</span>,</span>
<span>    col <span class="op">=</span> <span class="st">"Type of Tree"</span><span class="op">)</span> </span></code></pre></div>
</details><hr>
<p><strong>Layer 5</strong> Factor level labels and colours</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span></span>
<span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"artificial"</span> <span class="op">=</span> <span class="st">"green2"</span>, <span class="st">"real"</span> <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NULL1"</span>, <span class="st">"NULL2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Change <code>NULL</code> values to suitable labels for the two tree types.</p>
<p><strong>Layer 6</strong> Apply a theme.</p>
<p>AGain, not stricly APA but just to try out different things, keep it simple and apply</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Consider trying different themes. Change <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw()</a></code> to one of these below to see how it changes the plot. Which is your favourite?</p>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#or</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#or</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#or</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_grey</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>There you go, you now have a perfectly functioning line chart.</p>
</div>
<div id="snowman-plot" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> Snowman Plot<a class="anchor" aria-label="anchor" href="#snowman-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Now for some real serious complicated plotting‚Ä¶</p>
<p><code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> is really powerful and there are so many things you can do with it.</p>
<p>You‚Äôll need these packages.</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"ggforce"</span><span class="op">)</span> <span class="co"># you'll need this package if not installed</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggforce.data-imaginist.com">ggforce</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># if not already loaded</span></span></code></pre></div>
<p>Copy and paste the code below for the snowman plot‚Ä¶
The code is quite long so expand the section below to copy it, and then run it all at once.</p>
<hr>
<details><summary>
‚ùÑÔ∏è Click to build a snowman
</summary><div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">snowman</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, x <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">snowman</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_circle.html">geom_circle</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">x</span>, y0 <span class="op">=</span> <span class="va">y</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">snowman</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>y <span class="op">=</span><span class="op">(</span><span class="va">r</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">snowman</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_circle.html">geom_circle</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">x</span>, y0 <span class="op">=</span> <span class="va">y</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>,</span>
<span>              fill <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>              colour <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">face</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.75</span>, <span class="fl">.75</span>, <span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"eye"</span>, <span class="st">"eye"</span>, <span class="st">"nose"</span><span class="op">)</span>,</span>
<span>  colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="st">"black"</span>, <span class="st">"coral2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">face</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, </span>
<span>                 shape <span class="op">=</span> <span class="va">type</span>, colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">colour</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_arc.html">geom_arc</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">snowman</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">snowman</span><span class="op">)</span><span class="op">]</span>, </span>
<span>               y0 <span class="op">=</span> <span class="va">snowman</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">snowman</span><span class="op">)</span><span class="op">]</span>, </span>
<span>               start <span class="op">=</span> <span class="fl">2.2</span>, end <span class="op">=</span> <span class="fl">4</span>, r<span class="op">=</span><span class="fl">.6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">arms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">3.4</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">3.2</span>, <span class="fl">2</span>, <span class="fl">3.6</span>, <span class="fl">3.1</span>, <span class="fl">3.5</span>, <span class="fl">3.1</span>, <span class="fl">3.3</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">3.7</span>, <span class="op">-</span><span class="fl">3.2</span>, <span class="op">-</span><span class="fl">3.5</span>, <span class="op">-</span><span class="fl">3.2</span>, <span class="op">-</span><span class="fl">2.8</span>, <span class="op">-</span><span class="fl">3.7</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">3.2</span>, <span class="op">-</span><span class="fl">3.4</span>, <span class="op">-</span><span class="fl">3.1</span>, <span class="op">-</span><span class="fl">2.5</span><span class="op">)</span>,</span>
<span>    side <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"left arm"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"left finger1"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"left finger2"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"right arm"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"right finger1"</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"right finger2"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">arms</span>, </span>
<span>            size <span class="op">=</span> <span class="fl">1.5</span>, lineend <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">side</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">tophat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">1.1</span>, <span class="fl">0.8</span>, <span class="fl">1.5</span>, <span class="fl">1.4</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.25</span>, <span class="fl">.15</span>, <span class="fl">1</span>, <span class="fl">.75</span>, <span class="op">-</span><span class="fl">0.04</span>, <span class="op">-</span><span class="fl">.25</span>, <span class="op">-</span><span class="fl">.5</span><span class="op">)</span>,</span>
<span>                 id <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tophat</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scarf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">scarf</span>, size <span class="op">=</span> <span class="fl">3</span>, </span>
<span>            lineend<span class="op">=</span><span class="st">"round"</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"firebrick4"</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"skyblue3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This code was adapted from:</p>
<p>DrMowinckels (Dec 11, 2019) Do you wanna build a snowman?. Retrieved from <a href="https://drmowinckels.io/blog/2019/do-you-wanna-build-a-snowman/" class="uri">https://drmowinckels.io/blog/2019/do-you-wanna-build-a-snowman/</a>. DOI: <a href="https://www.doi.org/10.5281/zenodo.13273500" class="uri">https://www.doi.org/10.5281/zenodo.13273500</a></p>
</details><hr>
<p>Well Done. You have reached the end of the workshop</p>
<hr>
</div>
<div id="optional-exercises-and-resources-for-data-visualisation" class="section level2" number="10.6">
<h2>
<span class="header-section-number">10.6</span> Optional Exercises and Resources for Data Visualisation<a class="anchor" aria-label="anchor" href="#optional-exercises-and-resources-for-data-visualisation"><i class="fas fa-link"></i></a>
</h2>
<p>The code below might be useful for your lab report to display a main effect. You‚Äôll need the <code>tidyverse</code> package.</p>
</div>
<div id="bar-charts-for-t-tests-one-way-designs-or-main-effects" class="section level2" number="10.7">
<h2>
<span class="header-section-number">10.7</span> Bar Charts (for t-tests, one-way designs, or main effects)<a class="anchor" aria-label="anchor" href="#bar-charts-for-t-tests-one-way-designs-or-main-effects"><i class="fas fa-link"></i></a>
</h2>
<p>Download and import the hazard data set for this example. The code below assumes the data has been saved as an object called <code>mydata</code>.</p>
<p><a href="data/earlybird.csv">Download dataset</a>.</p>
<p>In this data set <code>cc</code> is the circadian chronotype either morning (lark), neither, or evening (owl) preference. <code>slp</code> is whether the participant reported a calm or disturbed night sleep. <code>alert</code> was the dependent variable and measured morning alertness. Although this is a factorial design, this example will only look at <code>cc</code> independent variable, similar to that of a one-way ANOVA or if you only wanted to report the main effect of circadian chronotype.</p>
<p>This is already in long format, so no need to amend it. However, it is good to check and re-order any factors.</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">cc</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lark"</span>, <span class="st">"neither"</span>, <span class="st">"owl"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">slp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">slp</span><span class="op">)</span></span></code></pre></div>
<div id="bar-chart-1" class="section level3" number="10.7.1">
<h3>
<span class="header-section-number">10.7.1</span> Bar Chart<a class="anchor" aria-label="anchor" href="#bar-chart-1"><i class="fas fa-link"></i></a>
</h3>
<p>This code will plot mean alertness scores for the three circadian chronotype groups <code>cc</code>, ignoring sleep quality <code>slp</code>.</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cc</span>, y <span class="op">=</span> <span class="va">alert</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>,</span>
<span>               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, </span>
<span>               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span>,   <span class="co"># keep NULL APA figures don't use titles.</span></span>
<span>       x <span class="op">=</span> <span class="st">"Circadian Chronotype"</span>,  </span>
<span>       y <span class="op">=</span> <span class="st">"Mean Alertness Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lark"</span>, <span class="st">"Neither"</span>, <span class="st">"Owl"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="violin-plot-1" class="section level3" number="10.7.2">
<h3>
<span class="header-section-number">10.7.2</span> Violin Plot<a class="anchor" aria-label="anchor" href="#violin-plot-1"><i class="fas fa-link"></i></a>
</h3>
<p>Same data set, just a different way to show the three groups.</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cc</span>, y <span class="op">=</span> <span class="va">alert</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>trim <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="st">"area"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">0.1</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, outlier.shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span>,   <span class="co"># keep NULL APA figures don't use titles.</span></span>
<span>       x <span class="op">=</span> <span class="st">"Circadian Chronotype"</span>,  </span>
<span>       y <span class="op">=</span> <span class="st">"Mean Alertness Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lark"</span>, <span class="st">"Neither"</span>, <span class="st">"Owl"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="box-plot-1" class="section level3" number="10.7.3">
<h3>
<span class="header-section-number">10.7.3</span> Box Plot<a class="anchor" aria-label="anchor" href="#box-plot-1"><i class="fas fa-link"></i></a>
</h3>
<p>Same data set, just a different way to show the three groups. All you‚Äôll notice here is the <code><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin()</a></code> function has been removed, because a box plot is essentially a violn plot but without the density information.</p>
<p>The width for the boxplot has also increased a little too.</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cc</span>, y <span class="op">=</span> <span class="va">alert</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, outlier.shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span>,   <span class="co"># keep NULL APA figures don't use titles.</span></span>
<span>       x <span class="op">=</span> <span class="st">"Circadian Chronotype"</span>,  </span>
<span>       y <span class="op">=</span> <span class="st">"Mean Alertness Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Morning"</span>, <span class="st">"Neither"</span>, <span class="st">"Evening"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If you have only two levels, this code will still work! You just need to remove the third label in <code><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete()</a></code> when you change the labels to match your data set. A bar chart example is below for an example using sleep qualit: calm vs.¬†disturbed.</p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">slp</span>, y <span class="op">=</span> <span class="va">alert</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"bar"</span>,</span>
<span>               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>               fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_se</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, </span>
<span>               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span>,   <span class="co"># keep NULL APA figures don't use titles.</span></span>
<span>       x <span class="op">=</span> <span class="st">"Sleep Quality"</span>,  </span>
<span>       y <span class="op">=</span> <span class="st">"Mean Alertness Score"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Calm"</span>, <span class="st">"Disturbed"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="workshop-9-non-parametric-statistics.html"><span class="header-section-number">9</span> Workshop 9: Non-Parametric Statistics</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#workshop-10-visualising-data"><span class="header-section-number">10</span> Workshop 10: Visualising Data</a></li>
<li>
<a class="nav-link" href="#bar-chart"><span class="header-section-number">10.1</span> Bar Chart</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercise-1.1-import-data"><span class="header-section-number">10.1.1</span> Exercise 1.1: Import Data</a></li>
<li><a class="nav-link" href="#exercise-1.2-build-the-bar-chart"><span class="header-section-number">10.1.2</span> Exercise 1.2: Build the Bar Chart</a></li>
<li><a class="nav-link" href="#exercise-1.3-tweaking-the-colours"><span class="header-section-number">10.1.3</span> Exercise 1.3: Tweaking the Colours</a></li>
<li><a class="nav-link" href="#exercise-1.4-saving-a-plot"><span class="header-section-number">10.1.4</span> Exercise 1.4: Saving a Plot</a></li>
</ul>
</li>
<li><a class="nav-link" href="#violin-plot"><span class="header-section-number">10.2</span> Violin Plot</a></li>
<li><a class="nav-link" href="#box-plot"><span class="header-section-number">10.3</span> Box Plot</a></li>
<li><a class="nav-link" href="#line-chart"><span class="header-section-number">10.4</span> Line Chart</a></li>
<li><a class="nav-link" href="#snowman-plot"><span class="header-section-number">10.5</span> Snowman Plot</a></li>
<li><a class="nav-link" href="#optional-exercises-and-resources-for-data-visualisation"><span class="header-section-number">10.6</span> Optional Exercises and Resources for Data Visualisation</a></li>
<li>
<a class="nav-link" href="#bar-charts-for-t-tests-one-way-designs-or-main-effects"><span class="header-section-number">10.7</span> Bar Charts (for t-tests, one-way designs, or main effects)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#bar-chart-1"><span class="header-section-number">10.7.1</span> Bar Chart</a></li>
<li><a class="nav-link" href="#violin-plot-1"><span class="header-section-number">10.7.2</span> Violin Plot</a></li>
<li><a class="nav-link" href="#box-plot-1"><span class="header-section-number">10.7.3</span> Box Plot</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>PS2010 Workshop Code Book</strong>" was written by Luke Kendrick. It was last built on 2025-12-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
